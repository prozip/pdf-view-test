<div id="pfbe" class="pf w0 h0" data-page-no="be"><div class="pc pcbe w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bgbe.png"/><div class="t m0 x42 h14 y80 ff7 fs7 fcb sc0 ls6 ws0">166</div><div class="t m0 xb9 h2b y1cf ffb fs18 fcb sc0 ls6 ws0">C</div><div class="t m0 xd3 h2c y1d0 ffb fs19 fcb sc0 lsf6 ws0">HAPTER</div><div class="t m0 xd9 h2b y1cf ffb fs18 fcb sc0 ls8c ws0"> 9</div><div class="t m0 x1f h2d y80 ffa fs7 fcb sc0 ls6 ws0">Keeping things lightweight</div><div class="t m0 x44 h15 y40 ff4 fsb fc3 sc0 ls42 wsc4">Fortunately, you won’t need to diagram ea<span class="ls36 ws4fc">ch function and method you write. A num-</span></div><div class="t m0 x44 h15 y41 ff4 fsb fc3 sc0 ls20 ws4ea">ber of tools out there, like SonarQube (<span class="fcc lsac ws0">www.sonarqube.org</span><span class="ls42 ws8c8">) and Radon (</span><span class="fcc ws0">https://</span></div><div class="t m0 x44 h15 y42 ff4 fsb fcc sc0 ls48 ws0">radon.readthedocs.io<span class="fc3 lsae ws1c9">), can measure these for you. These<span class="_ _0"></span> tools can even be integrat<span class="_ _0"></span>ed</span></div><div class="t m0 x44 h15 y43 ff4 fsb fc3 sc0 ls1b ws40">into your code e<span class="_ _e"></span>ditors so that you can break up c<span class="_ _e"></span>omplex code as you deve<span class="_ _e"></span>lop.</div><div class="t m0 x32 h15 y44 ff4 fsb fc3 sc0 ls2d ws344"> Now that you’ve learned some of the wa<span class="ls34 wsb6">ys to discover when code has grown com-</span></div><div class="t m0 x44 h15 y45 ff4 fsb fc3 sc0 ls1b ws40">plex, you can ge<span class="_ _e"></span>t some practice breaking <span class="_ _e"></span>down that complexity. </div><div class="t m0 x44 h1f y14b6 ffc fs13 fc2 sc0 ls7e ws269">Breaking down complexity<span class="_ _f0"></span>9<span class="_ _0"></span>.<span class="_ _1d"></span>2</div><div class="t m0 x44 h15 y48 ff4 fsb fc3 sc0 ls2d ws5a0">I have some mildly bad news: recognizing tha<span class="_ _0"></span>t code is complex is the easy part. The</div><div class="t m0 x44 h15 y49 ff4 fsb fc3 sc0 ls44 ws8c9">next challenge is understanding how to de<span class="ls2f ws8ca">al with specific kinds of <span class="_ _0"></span>complexity.</span></div><div class="t m0 x44 h15 y4a ff4 fsb fc3 sc0 ls6 ws8cb">Throughout the rest of this chapter<span class="_ _e"></span>, I’ll<span class="ls30 ws1ef"> point out some commo<span class="ls31 ws213">n patterns of complex-</span></span></div><div class="t m0 x44 h15 y4b ff4 fsb fc3 sc0 ls71 ws483">ity I’ve seen during my trav<span class="ls30 ws250">els with Python, and I’ll show you the options you have for</span></div><div class="t m0 x44 h15 y14b ff4 fsb fc3 sc0 ls3a ws28">tackling them.</div><div class="t m0 x44 h26 y2b1 ffc fs15 fc2 sc0 ls107 ws328">Extracting configuration<span class="_ _2d"></span>9<span class="_ _1d"></span>.2<span class="_ _1d"></span>.1</div><div class="t m0 x44 h15 y4f ff4 fsb fc3 sc0 ls34 ws9f">I’ll start with an example you’ve already seen<span class="ls42 ws26e"> in this book: as <span class="_ _e"></span>your software grows, cer-</span></div><div class="t m0 x44 h15 y2b2 ff4 fsb fc3 sc0 ls48 ws39">tain areas of the code nee<span class="_ _e"></span>d to continue adapting to new requirements.</div><div class="t m0 x32 h15 yed ff4 fsb fc3 sc0 ls2f ws467"> Imagine you’re building a <span class="_ _0"></span>web service th<span class="ls1e ws96">at indecisive users can query to see what</span></div><div class="t m0 x44 h15 y52 ff4 fsb fc3 sc0 ls30 ws220">they should eat for lunch.<span class="_ _e"></span> If a user goes to your service’s </div><div class="t m5 xcc h24 y14b7 ffd fsc fc3 sc0 lsa0 ws0">/random</div><div class="t m0 x7c h15 y52 ff4 fsb fc3 sc0 ls3a ws8cc"> endpoint, they</div><div class="t m0 x44 h15 y53 ff4 fsb fc3 sc0 ls1c ws21">should get a random food, like </div><div class="t m5 x93 h24 y14b8 ffd fsc fc3 sc0 lsa0 ws0">pizza</div><div class="t m0 xe h15 y53 ff4 fsb fc3 sc0 ls3e ws2d">, in return. Your initial handler function ac<span class="_ _0"></span>cepts</div><div class="t m0 x44 h15 y54 ff4 fsb fc3 sc0 ls71 wsd4">the user’s request as an argument, an<span class="ls78 ws0">d <span class="_ _e"></span>it might look somethi<span class="_ _e"></span>ng like this:</span></div><div class="t m0 x44 h3b y14b9 ffd fs18 fc3 sc0 lsb2 ws0">import<span class="_"> </span>random</div><div class="t m0 x44 h3b y5ca ffd fs18 fc3 sc0 lsb2 ws0">FOODS<span class="_"> </span>=<span class="_"> </span>[</div><div class="t m0 xae h3b y14ba ffd fs18 fc3 sc0 lsb2 ws0">&apos;pizza&apos;,</div><div class="t m0 xae h3b y14bb ffd fs18 fc3 sc0 lsb2 ws0">&apos;burgers&apos;,</div><div class="t m0 xae h3b y14bc ffd fs18 fc3 sc0 lsb2 ws0">&apos;salad&apos;,</div><div class="t m0 xae h3b y14bd ffd fs18 fc3 sc0 lsb2 ws0">&apos;soup&apos;,</div><div class="t m0 x44 h3b y14be ffd fs18 fc3 sc0 ls6 ws0">]</div><div class="t m0 x44 h3b y14bf ffd fs18 fc3 sc0 lsb2 ws0">def<span class="_"> </span>random_food(request):</div><div class="t m0 xae h3b y14c0 ffd fs18 fc3 sc0 lsb2 ws0">return<span class="_"> </span>random.choice(FOODS)</div><div class="c x140 y14c1 w28 h56"><div class="t m0 x12e h14 y65c ff12 fs7 fcb sc0 lsde ws2ad">A list of foods (This could go </div><div class="t m0 x12e h14 y65d ff12 fs7 fcb sc0 ls6 ws0">i<span class="ff13">n</span><span class="lsef ws4fa"> a database eve</span><span class="ff13">n</span><span class="ls125">tually.)</span></div></div><div class="c xd3 y14c2 w28 h10a"><div class="t m0 x12e h14 y14c3 ff12 fs7 fcb sc0 ls113 ws459">The fu<span class="ff13 ls6 ws0">n<span class="ff12 ls117">ctio</span>n</span><span class="lsd2 ws38c"> accepts the use<span class="ff13 ls6 ws0">r<span class="ff12 ls127">’s </span></span></span></div><div class="t m0 x12e h14 y14c4 ff12 fs7 fcb sc0 ls172 ws0">HTTP <span class="ff13 ls6">r</span><span class="ls12f ws64e">equest (u</span><span class="ff13 ls6">n</span><span class="lsdc ws2ac">used cu</span><span class="ff13 ls103">rr<span class="_ _0"></span><span class="ff12 ls6">e<span class="ff13">n</span><span class="ls105">tly).</span></span></span></div></div><div class="c x116 y14c5 w28 h56"><div class="t m0 x12e h14 y65c ff12 fs7 fcb sc0 lse0 ws0">Retu<span class="ff13 ls103">rn</span><span class="ls10e ws4f1">s a </span><span class="ff13 ls6">r<span class="ff12">a</span>n</span><span class="lsec">do<span class="ff13 ls6">m</span><span class="ls113 ws7ba"> food </span></span></div><div class="t m0 x12e h14 ydad ff12 fs7 fcb sc0 ls6 ws0">f<span class="ff13">r</span>o<span class="ff13">m</span><span class="lsda ws2aa"> the list, as a st</span><span class="ff13">r</span>i<span class="ff13">n</span>g</div></div><div class="t m0 x44 h15 y14c6 ff4 fsb fcd sc0 ls6 ws0">When your service gets<span class="_ _e"></span> popular (people are</div><div class="t m3 x0 h22 y14c6 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x2b h1b y14c6 ff3 fsb fcd sc0 ls6 ws0">all</div><div class="t m3 x0 h22 y14c6 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x98 h15 y14c6 ff4 fsb fcd sc0 ls6 ws0">indecisive), some us<span class="_ _e"></span>ers want to build a</div><div class="t m3 x0 h22 y14c6 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x44 h15 y14c7 ff4 fsb fcd sc0 ls6 ws0">full-fledged </div><div class="t m3 x0 h22 y14c7 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x15 h15 y14c7 ff4 fsb fcd sc0 ls6 ws0">app </div><div class="t m3 x0 h22 y14c7 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 xad h15 y14c7 ff4 fsb fcd sc0 ls6 ws0">around </div><div class="t m3 x0 h22 y14c7 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x3b h15 y14c7 ff4 fsb fcd sc0 ls6 ws0">it. </div><div class="t m3 x0 h22 y14c7 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 xc9 h15 y14c7 ff4 fsb fcd sc0 ls6 ws0">They </div><div class="t m3 x0 h22 y14c7 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x133 h15 y14c7 ff4 fsb fcd sc0 ls6 ws0">tell </div><div class="t m3 x0 h22 y14c7 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x85 h15 y14c7 ff4 fsb fcd sc0 ls6 ws0">you</div><div class="t m3 x0 h22 y14c7 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x65 h15 y14c7 ff4 fsb fcd sc0 ls6 ws0">they </div><div class="t m3 x0 h22 y14c7 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x98 h15 y14c7 ff4 fsb fcd sc0 ls6 ws0">want </div><div class="t m3 x0 h22 y14c7 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x14 h15 y14c7 ff4 fsb fcd sc0 ls6 ws0">to </div><div class="t m3 x0 h22 y14c7 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x6e h15 y14c7 ff4 fsb fcd sc0 ls6 ws0">get </div><div class="t m3 x0 h22 y14c7 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x104 h15 y14c7 ff4 fsb fcd sc0 ls6 ws0">the </div><div class="t m3 x0 h22 y14c7 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x72 h15 y14c7 ff4 fsb fcd sc0 ls6 ws0">response </div><div class="t m3 x0 h22 y14c7 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 xaa h15 y14c7 ff4 fsb fcd sc0 ls6 ws0">from </div><div class="t m3 x0 h22 y14c7 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x112 h15 y14c7 ff4 fsb fcd sc0 ls6 ws0">you </div><div class="t m3 x0 h22 y14c7 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 xb0 h15 y14c7 ff4 fsb fcd sc0 ls6 ws0">in</div><div class="t m3 x0 h22 y14c7 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x44 h15 y14c8 ff4 fsb fcd sc0 ls6 ws0">JSON </div><div class="t m3 x0 h22 y14c8 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x87 h15 y14c8 ff4 fsb fcd sc0 ls6 ws0">format </div><div class="t m3 x0 h22 y14c8 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x8c h15 y14c8 ff4 fsb fcd sc0 ls6 ws0">because </div><div class="t m3 x0 h22 y14c8 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x92 h15 y14c8 ff4 fsb fcd sc0 ls6 ws0">it’s </div><div class="t m3 x0 h22 y14c8 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 xe7 h15 y14c8 ff4 fsb fcd sc0 ls6 ws0">easy </div><div class="t m3 x0 h22 y14c8 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x56 h15 y14c8 ff4 fsb fcd sc0 ls6 ws0">to </div><div class="t m3 x0 h22 y14c8 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x5d h15 y14c8 ff4 fsb fcd sc0 ls6 ws0">work </div><div class="t m3 x0 h22 y14c8 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x64 h15 y14c8 ff4 fsb fcd sc0 ls6 ws0">with. </div><div class="t m3 x0 h22 y14c8 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x6c h15 y14c8 ff4 fsb fcd sc0 ls6 ws0">You </div><div class="t m3 x0 h22 y14c8 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x5e h15 y14c8 ff4 fsb fcd sc0 ls6 ws0">don’t </div><div class="t m3 x0 h22 y14c8 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x139 h15 y14c8 ff4 fsb fcd sc0 ls6 ws0">want </div><div class="t m3 x0 h22 y14c8 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x4d h15 y14c8 ff4 fsb fcd sc0 ls6 ws0">to </div><div class="t m3 x0 h22 y14c8 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x33 h15 y14c8 ff4 fsb fcd sc0 ls6 ws0">change </div><div class="t m3 x0 h22 y14c8 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x105 h15 y14c8 ff4 fsb fcd sc0 ls6 ws0">the </div><div class="t m3 x0 h22 y14c8 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 xfc h15 y14c8 ff4 fsb fcd sc0 ls6 ws0">default</div><div class="t m3 x0 h22 y14c8 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x44 h15 y14c9 ff4 fsb fcd sc0 ls6 ws0">behavior <span class="_ _e"></span>fo<span class="_ _e"></span>r <span class="_ _e"></span>the <span class="_ _e"></span>res<span class="_ _e"></span>t <span class="_ _e"></span>of <span class="_ _e"></span>your <span class="_ _f"></span>users, <span class="_ _e"></span>so <span class="_ _f"></span>you <span class="_ _e"></span>tell <span class="_ _f"></span>them <span class="_ _e"></span>you’ll <span class="_ _f"></span>return <span class="_ _e"></span>a <span class="_ _f"></span>JSON <span class="_ _e"></span>response <span class="_ _f"></span>if</div><div class="t m3 x0 h22 y14c9 ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x44 h15 y14ca ff4 fsb fcd sc0 ls6 ws0">they send an</div><div class="t m3 x0 h22 y14ca ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m4 x1c h24 y14cb ffd fsc fcd sc0 ls6 ws0">Accep<span class="_ _0"></span>t: app<span class="_ _0"></span>licati<span class="_ _0"></span>on/json</div><div class="t m3 x0 h25 y14cb ff8 fsc fcd sc0 ls6 ws0"> </div><div class="t m0 x27 h15 y14cb ff4 fsb fcd sc0 ls6 ws0">header in their request. (Do<span class="_ _e"></span>n’t worry much</div><div class="t m3 x0 h22 y14cb ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x44 h15 y14cc ff4 fsb fcd sc0 ls6 ws0">about <span class="_ _e"></span>how <span class="_ _f"></span>HTTP <span class="_ _e"></span>headers <span class="_ _e"></span>wor<span class="_ _e"></span>k <span class="_ _e"></span>if <span class="_ _e"></span>you’re <span class="_ _e"></span>no<span class="_ _e"></span>t <span class="_ _e"></span>already <span class="_ _e"></span>familia<span class="_ _e"></span>r <span class="_ _e"></span>with <span class="_ _e"></span>them; <span class="_ _e"></span>a<span class="_ _e"></span>ssume <span class="_ _e"></span>that</div><div class="t m4 x44 h24 y14cd ffd fsc fcd sc0 ls6 ws0">reque<span class="_ _0"></span>st.head<span class="_ _0"></span>ers</div><div class="t m3 x0 h25 y14cd ff8 fsc fcd sc0 ls6 ws0"> </div><div class="t m0 xa7 h15 y14cd ff4 fsb fcd sc0 ls6 ws0">is a <span class="_ _0"></span>dictionary of header <span class="_ _0"></span>names</div><div class="t m3 x0 h22 y14cd ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x4c h15 y14cd ff4 fsb fcd sc0 ls6 ws0">to header values.) You <span class="_ _0"></span>could update</div><div class="t m3 x0 h22 y14cd ff8 fsb fcd sc0 ls6 ws0"> </div><div class="t m0 x44 h15 y14ce ff4 fsb fcd sc0 ls6 ws0">your function to <span class="_ _e"></span>account for this:</div><div class="t m0 x44 h3b y14cf ffd fs18 fcd sc0 ls6 ws0">import</div><div class="t m3 x0 h3a y14cf ff8 fs18 fcd sc0 ls6 ws0"> </div><div class="t m0 x4 h3b y14cf ffd fs18 fcd sc0 ls6 ws0">json</div><div class="t m0 x44 h3b y14d0 ffd fs18 fcd sc0 ls6 ws0">import</div><div class="t m3 x0 h3a y14d0 ff8 fs18 fcd sc0 ls6 ws0"> </div><div class="t m0 x4 h3b y14d0 ffd fs18 fcd sc0 ls6 ws0">random</div><div class="t m0 x44 h3b yb9e ffd fs18 fcd sc0 ls6 ws0">...</div><a class="l" href="https://radon.readthedocs.io"><div class="d m2" style="border-style:none;position:absolute;left:362.400000px;bottom:588.518000px;width:66.720000px;height:11.220000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="https://www.sonarqube.org"><div class="d m2" style="border-style:none;position:absolute;left:277.200000px;bottom:588.518000px;width:85.200000px;height:11.220000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
