<div id="pfc8" class="pf w0 h0" data-page-no="c8"><div class="pc pcc8 w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bgc8.png"/><div class="t m0 x42 h14 y80 ff7 fs7 fcb sc0 ls6 ws0">176</div><div class="t m0 xb9 h2b y1cf ffb fs18 fcb sc0 ls6 ws0">C</div><div class="t m0 xd3 h2c y1d0 ffb fs19 fcb sc0 lsf6 ws0">HAPTER</div><div class="t m0 xd9 h2b y1cf ffb fs18 fcb sc0 ls8c ws0"> 9</div><div class="t m0 x1f h2d y80 ffa fs7 fcb sc0 ls6 ws0">Keeping things lightweight</div><div class="t m0 x44 h15 y40 ff4 fsb fc3 sc0 ls21a ws5a">Do y<span class="_ _0"></span>ou no<span class="_ _0"></span>tic<span class="_ _0"></span>e tha<span class="_ _1d"></span>t even t<span class="_ _0"></span>hou<span class="_ _0"></span>gh th<span class="_ _0"></span>e co<span class="_ _0"></span>de no<span class="_ _0"></span>w ha<span class="_ _0"></span>s mor<span class="_ _0"></span>e li<span class="_ _0"></span>nes<span class="_ _0"></span>, ea<span class="_ _0"></span>ch li<span class="_ _0"></span>ne h<span class="_ _0"></span>as be<span class="_ _0"></span>en s<span class="_ _0"></span>im-</div><div class="t m0 x44 h15 y41 ff4 fsb fc3 sc0 ls2d ws3eb">plified? And looking at the classes, it’s <span class="_ _0"></span>a bit <span class="ls42 ws8c">easier to tell what kind of information they</span></div><div class="t m0 x44 h15 y42 ff4 fsb fc3 sc0 ls38 ws9e">contain. Eventually, much of the code still in </div><div class="t m5 x40 h24 y66f ffd fsc fc3 sc0 lsa0 ws0">Book</div><div class="t m0 x4c h15 y533 ff4 fsb fc3 sc0 lsf3 ws0"> w<span class="_ _e"></span>il<span class="_ _e"></span>l a<span class="_ _e"></span>l<span class="_ _e"></span>so<span class="_ _e"></span> be<span class="_ _e"></span> r<span class="_ _e"></span>em<span class="_ _e"></span>ov<span class="_ _e"></span>e<span class="_ _e"></span>d,<span class="_ _e"></span> at<span class="_ _e"></span> w<span class="_ _e"></span>hi<span class="_ _e"></span>ch<span class="_ _e"></span> p<span class="_ _e"></span>oi<span class="_ _e"></span>n<span class="_ _e"></span>t</div><div class="t m5 x44 h24 y71c ffd fsc fc3 sc0 lsa0 ws0">Book</div><div class="t m0 xae h15 y43 ff4 fsb fc3 sc0 ls44 ws51f"> will be leveraging c<span class="_ _0"></span>omposition of the </div><div class="t m5 x3f h24 y71c ffd fsc fc3 sc0 lsa0 ws0">Author</div><div class="t m0 x75 h15 y43 ff4 fsb fc3 sc0 ls20 wsac"> class to provide information about</div><div class="t m0 x44 h15 y44 ff4 fsb fc3 sc0 ls31 ws25">its authors.</div><div class="t m0 x32 h15 y45 ff4 fsb fc3 sc0 ls18b ws0"> I<span class="_ _1d"></span>f<span class="_ _0"></span> y<span class="_ _1d"></span>ou<span class="_ _1c"></span> wa<span class="_ _1d"></span>n<span class="_ _1d"></span>t<span class="_ _0"></span> t<span class="_ _1d"></span>o<span class="_ _0"></span> b<span class="_ _1d"></span>e <span class="ff3 lsf8">really</span><span class="ls31 ws200"> nice to your consumers as <span class="ls71 ws1cb">you decompose a class, you can</span></span></div><div class="t m0 x44 h15 y46 ff4 fsb fc3 sc0 ls3d ws13d">also leave them hints so they know they <span class="_ _e"></span><span class="ls34 ws469">should switch <span class="ls20 ws1e6">to the new code. For example,</span></span></div><div class="t m0 x44 h15 ye3 ff4 fsb fc3 sc0 ls51 ws8fc">you want the consumers of </div><div class="t m5 x56 h24 y15db ffd fsc fc3 sc0 lsa0 ws0">Book</div><div class="t m0 xd0 h15 ye3 ff4 fsb fc3 sc0 ls3d ws8fd"> to move from </div><div class="t m5 x111 h24 y15db ffd fsc fc3 sc0 lsa0 ws0">book.author_<span class="_ _e"></span>for_display</div><div class="t m0 x108 h15 ye3 ff4 fsb fc3 sc0 ls74 ws8fe"> to</div><div class="t m5 x44 h24 y15dc ffd fsc fc3 sc0 lsa0 ws0">book.author.f<span class="_ _e"></span>or_display</div><div class="t m0 xe7 h15 y48 ff4 fsb fc3 sc0 ls20 ws202"> so that you can remove the forwarding. Python has a built-</div><div class="t m0 x44 h15 y49 ff4 fsb fc3 sc0 ls38 ws1f4">in system for this kind<span class="ls34 ws9f"> of messaging, <span class="_ _0"></span>called </span></div><div class="t m5 x3f h24 yf95 ffd fsc fc3 sc0 lsa0 ws0">warnings</div><div class="t m0 x10f h15 y49 ff4 fsb fc3 sc0 ls6 ws0">.</div><div class="t m0 x32 h15 y4a ff4 fsb fc3 sc0 ls25 ws60d"> One type of warning is specifically a </div><div class="t m5 x84 h24 yf96 ffd fsc fc3 sc0 lsa0 ws0">DeprecationWa<span class="_ _e"></span>rning</div><div class="t m0 x103 h15 y4a ff4 fsb fc3 sc0 ls25 ws60d">, which you can use to let</div><div class="t m0 x44 h15 y5ab ff4 fsb fc3 sc0 ls81 ws146">people kno<span class="_ _e"></span>w that something should no<span class="_ _e"></span> longer be used. This w<span class="_ _e"></span>arning generally pri<span class="_ _e"></span>nts</div><div class="t m0 x44 h15 y14b ff4 fsb fc3 sc0 ls2f wsa2">a message in a program’s output telling the <span class="ls3d ws2c">user they sho<span class="_ _e"></span>uld make a change. A depre-</span></div><div class="t m0 x44 h15 y4d ff4 fsb fc3 sc0 ls79 wsf6">cation warning <span class="_ _e"></span>can be produced as follow<span class="_ _e"></span>s:</div><div class="t m0 x44 h3b yf97 ffd fs18 fc3 sc0 lsb2 ws0">import<span class="_"> </span>warnings</div><div class="t m0 x44 h3b y15dd ffd fs18 fc1 sc0 lsb2 ws0">warnings.warn(&apos;Do<span class="_"> </span>not<span class="_"> </span>use<span class="_"> </span>this<span class="_"> </span>anymore!&apos;,<span class="_"> </span>DeprecationWarning)</div><div class="t m0 x44 h15 y52 ff4 fsb fc3 sc0 ls34 ws569">You can help consumers upgrade th<span class="ls44 ws3b7">eir code smoothly by adding a </span></div><div class="t m5 x5 h24 y14b7 ffd fsc fc3 sc0 lsa0 ws0">DeprecationWa<span class="_ _e"></span>rning</div><div class="t m0 x44 h15 y53 ff4 fsb fc3 sc0 ls3a ws881">to each method you eventually want to remove.</div><div class="t m0 x6c h31 y107c ff4 fs1a fc3 sc0 ls6 ws0">1</div><div class="t m0 x98 h15 y53 ff4 fsb fc3 sc0 ls3d ws8ff"> Try adding them to the author-related</div><div class="t m0 x44 h15 y54 ff4 fsb fc3 sc0 ls34 ws185">properties in the </div><div class="t m5 x28 h24 y15de ffd fsc fc3 sc0 lsa0 ws0">Book</div><div class="t m0 xd6 h15 y54 ff4 fsb fc3 sc0 ls38 ws256"> class now. You can say <span class="ls7d ws334">something useful like </span></div><div class="t m5 x117 h24 y15de ffd fsc fc3 sc0 lsa0 ws900">&apos;Use book.autho<span class="_ _e"></span>r</div><div class="t m5 x44 h24 y435 ffd fsc fc3 sc0 lsa0 ws901">.for_display in<span class="_ _e"></span>stead&apos;</div><div class="t m0 x23 h15 y199 ff4 fsb fc3 sc0 ls2e ws902">. If you run the code now, yo<span class="ls34 ws837">u should see warning messages <span class="_ _0"></span>in</span></div><div class="t m0 x44 h15 y19a ff4 fsb fc3 sc0 ls5e ws57">the output that look like the following:</div><div class="t m0 x44 h3b y15df ffd fs18 fc3 sc0 lsb2 ws0">/path/to/book.py:24:<span class="_"> </span>DeprecationWarning:<span class="_"> </span>Use<span class="_"> </span>book.author.for_display<span class="_"> </span>instead</div><div class="t m0 x44 h15 y15e0 ff4 fsb fc3 sc0 ls71 ws341">Congratulations! You’ve extracted a new class,<span class="ls34 ws694"> breaking down the complexity <span class="_ _e"></span>of a class</span></div><div class="t m0 x44 h15 y15e1 ff4 fsb fc3 sc0 ls2d ws177">that outgrew itself. You did it in a backward-c<span class="_ _0"></span>ompatible way, leaving hints for users so</div><div class="t m0 x44 h15 y15e2 ff4 fsb fc3 sc0 ls71 ws2f6">they know what’s coming and how to fix it<span class="ls34 ws42d">. <span class="_ _e"></span>This resulted in more structured, more</span></div><div class="t m0 x44 h15 y124c ff4 fsb fc3 sc0 ls42 ws26e">readable code with<span class="ls1c ws21"> separate concerns and stro<span class="ls51 ws47">ng cohesion. Well done, you. </span></span></div><div class="t m0 x44 h1f y15e3 ffc fs13 fc2 sc0 lsa9 ws0">Summary</div><div class="t m0 x86 h29 y15e4 ffe fs17 fca sc0 ls6 ws0"></div><div class="t m0 x87 h15 y15e5 ff4 fsb fc3 sc0 ls34 ws185">Code complexity and separate<span class="ws3a8"> concerns are better metrics than physical size for</span></div><div class="t m0 x87 h15 y15e6 ff4 fsb fc3 sc0 ls3b ws70">breaking up code.</div><div class="t m0 x86 h29 y15e7 ffe fs17 fca sc0 ls6 ws0"></div><div class="t m0 x87 h15 y15e8 ff4 fsb fc3 sc0 ls36 ws33b">Cyclomatic complexity measures the <span class="_ _0"></span>nu<span class="ls42 ws37e">mber of execution paths through your</span></div><div class="t m0 x87 h15 y15e9 ff4 fsb fc3 sc0 lsbb ws0">code.</div><div class="t m0 x86 h29 yce0 ffe fs17 fca sc0 ls6 ws0"></div><div class="t m0 x87 h15 y89d ff4 fsb fc3 sc0 ls2f ws903">Extract configuration, func<span class="ls7a ws904">tions, method<span class="_ _0"></span>s, and cla<span class="ls2f ws903">sses freely to break down</span></span></div><div class="t m0 x87 h15 y89f ff4 fsb fc3 sc0 ls78 ws0">complexity.</div><div class="t m0 x86 h29 y15ea ffe fs17 fca sc0 ls6 ws0"></div><div class="t m0 x87 h15 y15eb ff4 fsb fc3 sc0 ls3b ws1ee">Use forwarding and depr<span class="_ _e"></span>ecation warnings to temporarily support <span class="_ _e"></span>the new and</div><div class="t m0 x87 h15 y15ec ff4 fsb fc3 sc0 ls3a ws1e0">old ways of doing things.</div><div class="t m0 x42 h32 yce5 ff4 fs1b fcd sc0 ls6 ws0">1</div><div class="t m0 x43 h33 y981 ff4 fs17 fcd sc0 ls6 ws0">See </div><div class="t m3 x0 h34 y981 ff8 fs17 fcd sc0 ls6 ws0"> </div><div class="t m0 xb h33 y981 ff4 fs17 fcd sc0 ls6 ws0">Brett </div><div class="t m3 x0 h34 y981 ff8 fs17 fcd sc0 ls6 ws0"> </div><div class="t m0 x12c h33 y981 ff4 fs17 fcd sc0 ls6 ws0">Slatkin, </div><div class="t m3 x0 h34 y981 ff8 fs17 fcd sc0 ls6 ws0"> </div><div class="t m0 x20 h33 y981 ff4 fs17 fcd sc0 ls6 ws0">“Refactoring </div><div class="t m3 x0 h34 y981 ff8 fs17 fcd sc0 ls6 ws0"> </div><div class="t m0 x67 h33 y981 ff4 fs17 fcd sc0 ls6 ws0">Python:</div><div class="t m3 x0 h34 y981 ff8 fs17 fcd sc0 ls6 ws0"> </div><div class="t m0 x8d h33 y981 ff4 fs17 fcd sc0 ls6 ws0">Why </div><div class="t m3 x0 h34 y981 ff8 fs17 fcd sc0 ls6 ws0"> </div><div class="t m0 x11 h33 y981 ff4 fs17 fcd sc0 ls6 ws0">and </div><div class="t m3 x0 h34 y981 ff8 fs17 fcd sc0 ls6 ws0"> </div><div class="t m0 xe h33 y981 ff4 fs17 fcd sc0 ls6 ws0">how </div><div class="t m3 x0 h34 y981 ff8 fs17 fcd sc0 ls6 ws0"> </div><div class="t m0 x27 h33 y981 ff4 fs17 fcd sc0 ls6 ws0">to </div><div class="t m3 x0 h34 y981 ff8 fs17 fcd sc0 ls6 ws0"> </div><div class="t m0 x2b h33 y981 ff4 fs17 fcd sc0 ls6 ws0">restructure </div><div class="t m3 x0 h34 y981 ff8 fs17 fcd sc0 ls6 ws0"> </div><div class="t m0 xcd h33 y981 ff4 fs17 fcd sc0 ls6 ws0">your </div><div class="t m3 x0 h34 y981 ff8 fs17 fcd sc0 ls6 ws0"> </div><div class="t m0 xe1 h33 y981 ff4 fs17 fcd sc0 ls6 ws0">code,”</div><div class="t m3 x0 h34 y981 ff8 fs17 fcd sc0 ls6 ws0"> </div><div class="t m0 x14e had y981 ff3 fs17 fcd sc0 ls6 ws0">PyCon </div><div class="t m3 x0 h34 y981 ff8 fs17 fcd sc0 ls6 ws0"> </div><div class="t m0 xd4 h33 y981 ff3 fs17 fcd sc0 ls6 ws0">2016<span class="ff4">,</span></div><div class="t m3 x0 h34 y981 ff8 fs17 fcd sc0 ls6 ws0"> </div><div class="t m0 x10a h33 y981 ff4 fs17 fcf sc0 ls6 ws0">www.you-</div><div class="t m0 x43 h33 y211 ff4 fs17 fcf sc0 ls6 ws0">tube.com/watc<span class="_ _e"></span>h?v=D_6ybDcU5gc<span class="fcd">, for a trea<span class="_ _e"></span>sure trove of deprec<span class="_ _e"></span>ation and extraction tricks<span class="_ _e"></span>.</span></div><a class="l" href="https://www.youtube.com/watch?v=D_6ybDcU5gc"><div class="d m2" style="border-style:none;position:absolute;left:431.280000px;bottom:71.858000px;width:33.840000px;height:10.440000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="https://www.youtube.com/watch?v=D_6ybDcU5gc"><div class="d m2" style="border-style:none;position:absolute;left:57.120000px;bottom:61.718000px;width:128.280000px;height:10.140000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
