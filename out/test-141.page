<div id="pf8d" class="pf w0 h0" data-page-no="8d"><div class="pc pc8d w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg8d.png"/><div class="t m0 xa0 h14 y80 ff7 fs7 fcb sc0 ls6 ws0">117<span class="_ _aa"></span><span class="ffa">An initial code structure, by concern</span></div><div class="t m0 x35 h3b y2c2 ffd fs18 fc3 sc0 lsb2 ws0">db<span class="_"> </span>=<span class="_"> </span>DatabaseManager(&apos;bookmarks.db&apos;)</div><div class="t m0 x35 h3b y2c5 ffd fs18 fc3 sc0 lsb2 ws0">class<span class="_"> </span>CreateBookmarksTableCommand:</div><div class="t m0 x87 h3b y2c6 ffd fs18 fc3 sc0 lsb2 ws0">def<span class="_"> </span>execute(self):</div><div class="t m0 x36 h3b y2c7 ffd fs18 fc3 sc0 lsb2 ws0">db.create_table(&apos;bookmarks&apos;,<span class="_"> </span>{</div><div class="t m0 xe6 h3b y2c8 ffd fs18 fc3 sc0 lsb2 ws0">&apos;id&apos;:<span class="_"> </span>&apos;integer<span class="_"> </span>primary<span class="_"> </span>key<span class="_"> </span>autoincrement&apos;,</div><div class="t m0 xe6 h3b y2c9 ffd fs18 fc3 sc0 lsb2 ws0">&apos;title&apos;:<span class="_"> </span>&apos;text<span class="_"> </span>not<span class="_"> </span>null&apos;,</div><div class="t m0 xe6 h3b y2ca ffd fs18 fc3 sc0 lsb2 ws0">&apos;url&apos;:<span class="_"> </span>&apos;text<span class="_"> </span>not<span class="_"> </span>null&apos;,</div><div class="t m0 xe6 h3b y2cb ffd fs18 fc3 sc0 lsb2 ws0">&apos;notes&apos;:<span class="_"> </span>&apos;text&apos;,</div><div class="t m0 xe6 h3b y2cc ffd fs18 fc3 sc0 lsb2 ws0">&apos;date_added&apos;:<span class="_"> </span>&apos;text<span class="_"> </span>not<span class="_"> </span>null&apos;,</div><div class="t m0 x36 h3b y2cd ffd fs18 fc1 sc0 lsb2 ws0">})</div><div class="t m0 x35 h15 yf04 ff4 fsb fc3 sc0 ls3a ws296">Notice that the command is only aware of<span class="ls25 ws755"> its duties (calling persistence layer logic)</span></div><div class="t m0 x35 h15 yf05 ff4 fsb fc3 sc0 ls71 ws2e0">and the interface of its dependency (</div><div class="t m5 x13 h24 yf06 ffd fsc fc3 sc0 lsa0 ws0">DatabaseManag<span class="_ _e"></span>er.create_table</div><div class="t m0 x7 h15 yf05 ff4 fsb fc3 sc0 ls36 ws230">). This is loose</div><div class="t m0 x35 h15 yf07 ff4 fsb fc3 sc0 ls44 ws352">coupling, thanks in part to separati<span class="_ _0"></span>ng th<span class="ls30 wse3">e persistence logic and (eventually)<span class="_ _e"></span> the pre-</span></div><div class="t m0 x35 h15 yf08 ff4 fsb fc3 sc0 ls72 ws6c">sentation <span class="_ _e"></span>logic. You should<span class="_ _e"></span> be seeing the be<span class="_ _e"></span><span class="ls20 ws202">nefits of separation of concerns more and</span></div><div class="t m0 x35 h15 yf09 ff4 fsb fc3 sc0 ls2e ws4d">more clearly as you work through these exercises. </div><div class="t m0 x35 h30 yf0a ffb fsc fc2 sc0 ls6 ws0">A</div><div class="t m0 xbc h5a yf0b ffb fs20 fc2 sc0 ls11c ws0">DDING</div><div class="t m0 x97 h30 yf0a ffb fsc fc2 sc0 ls6 ws0"> </div><div class="t m0 x20 h5a yf0b ffb fs20 fc2 sc0 ls1c4 ws0">BOOKMARKS</div><div class="t m0 x35 h15 yf0c ff4 fsb fc3 sc0 ls3a ws254">To add a bookmark, you’ll need to pass data <span class="ls3b ws61a">received from the present<span class="_ _e"></span>ation layer on</span></div><div class="t m0 x35 h15 yf0d ff4 fsb fc3 sc0 ls7d ws756">to the persistence layer. The data w<span class="_ _e"></span>ill be passed as a dictionary mapping column</div><div class="t m0 x35 h15 yf0e ff4 fsb fc3 sc0 ls42 ws1ec">names to values. This is a great example of code relying on a shared interface rather</div><div class="t m0 x35 h15 yf0f ff4 fsb fc3 sc0 ls42 ws12e">than the specifics of an implementation. If<span class="ls31 ws116"> the persistence layer and <span class="_ _e"></span>the business logic</span></div><div class="t m0 x35 h15 yf10 ff4 fsb fc3 sc0 ls31 ws469">layer agree on a data format, they can each <span class="ls1c ws1c4">do what they need <span class="_ _0"></span>to, as long as the data</span></div><div class="t m0 x35 h15 yf11 ff4 fsb fc3 sc0 ls31 ws25">format stays consistent.</div><div class="t m0 x83 h15 yf12 ff4 fsb fc3 sc0 ls51 ws47"> Write an </div><div class="t m5 x37 h24 yf13 ffd fsc fc3 sc0 lsa0 ws0">AddBookmark<span class="_ _e"></span>Command</div><div class="t m0 x4b h15 y96a ff4 fsb fc3 sc0 ls38 ws26"> class that will perform this operation. This class will</div><div class="t m0 x8a h3d yf14 ffb fs1e fca sc0 ls6 ws0">1</div><div class="t m0 x48 h15 y849 ff4 fsb fc3 sc0 ls1f ws1ab">Expect a dictionary containing the ti<span class="_ _0"></span>tle,<span class="ls2f ws36e"> URL, and (optional) notes information</span></div><div class="t m0 x48 h15 y81e ff4 fsb fc3 sc0 ls51 ws47">for a bookmark.</div><div class="t m0 x8a h3d yf15 ffb fs1e fca sc0 ls6 ws0">2</div><div class="t m0 x48 h15 yf16 ff4 fsb fc3 sc0 lsb1 ws757">Add the current<span class="_ _0"></span> datetime to t<span class="_ _0"></span>he dictionary as </div><div class="t m5 x6e h24 yf17 ffd fsc fc3 sc0 lsa0 ws0">date_added</div><div class="t m0 x115 h15 yf16 ff4 fsb fc3 sc0 ls35 ws758">. To get the current</div><div class="t m0 x48 h15 yf18 ff4 fsb fc3 sc0 ls2f ws10d">time in UTC, in a standardized fo<span class="ls31 ws2b7">rmat with wide compatibility, use </span></div><div class="t m5 xe3 h24 yf19 ffd fsc fc3 sc0 lsa0 ws0">datetime</div><div class="t m5 x48 h24 yf1a ffd fsc fc3 sc0 lsa0 ws0">.datetime.utc<span class="_ _e"></span>now().isoformat()</div><div class="t m0 x7b h15 yf1b ff4 fsb fc3 sc0 ls6 ws0">.</div><div class="t m0 x2b h31 yf1c ff4 fs1a fc3 sc0 ls6 ws0">3</div><div class="t m0 x8a h3d yf1d ffb fs1e fca sc0 ls6 ws0">3</div><div class="t m0 x48 h15 yf1e ff4 fsb fc3 sc0 lseb ws759">Insert the data into the bookmarks table using the </div><div class="t m5 x4f h24 yf1f ffd fsc fc3 sc0 ls1c7 ws0">DatabaseManage<span class="_ _0"></span>r.add</div><div class="t m0 xa4 h15 yf1e ff4 fsb fc3 sc0 ls1c8 ws75a"> method.</div><div class="t m0 x8a h3d yf20 ffb fs1e fca sc0 ls6 ws0">4</div><div class="t m0 x48 h15 ye4d ff4 fsb fc3 sc0 ls71 ws1c0">Return a success message that will even<span class="ls20 wsb0">tually be displayed by the presentation</span></div><div class="t m0 x48 h15 ye4e ff4 fsb fc3 sc0 ls62 ws0">layer.</div><div class="t m0 x35 h15 yf21 ff4 fsb fc3 sc0 ls25 ws1a">Check your work against the following listing.</div><div class="t m0 x35 h3b yf22 ffd fs18 fc3 sc0 lsb2 ws0">from<span class="_"> </span>datetime<span class="_"> </span>import<span class="_"> </span>datetime</div><div class="t m0 x35 h3b y584 ffd fs18 fc3 sc0 lsb2 ws0">...</div><div class="t m0 x17 h20 y2ea ffb fs7 fc4 sc0 ls6 ws0">A command for creating a table<span class="_ _ae"></span>Listing<span class="_"> </span>6.6</div><div class="t m0 x17 h20 yf23 ffb fs7 fc4 sc0 ls6 ws0">A command for adding a bookmark<span class="_ _af"></span>Listing<span class="_"> </span>6.7</div><div class="c x85 yf24 w6a ha0"><div class="t m0 x42 h14 yf25 ff12 fs7 fcb sc0 ls100 ws0">Re<span class="ff13 ls6">m<span class="ff12">e</span>m</span><span class="lsec">be<span class="ff13 ls6">r</span><span class="lsee ws2cf">, sqlite3 will </span></span></div><div class="t m0 x42 h14 yf26 ff12 fs7 fcb sc0 ls10f ws0">auto<span class="ff13 ls6">m</span><span class="lsfd ws31a">atically c</span><span class="ff13 ls6">r</span><span class="ls105 ws327">eate this </span></div><div class="t m0 x42 h14 yf27 ff12 fs7 fcb sc0 lsda ws2aa">database file if it does<span class="ff13 ls6 ws0">n</span><span class="lsdf ws2ae">’t exist.</span></div></div><div class="c x136 ye2b w6b hd8"><div class="t m0 xfb h14 yf28 ff12 fs7 fcb sc0 lsff ws315">This will </div><div class="t m0 xfb h14 yf29 ff12 fs7 fcb sc0 lsd5 ws0">eve<span class="ff13 ls6">n</span><span class="lsda ws75b">tually be </span></div><div class="t m0 xfb h14 yf2a ff12 fs7 fcb sc0 ls6 ws317">called whe<span class="ff13 ws0">n<span class="ff12"> </span></span></div><div class="t m0 xfb h14 ydce ff12 fs7 fcb sc0 ls145 ws0">Ba<span class="ff13 ls6">r</span><span class="ls13c ws75c">k sta</span><span class="ff13 ls6">r</span><span class="lsec">ts </span></div><div class="t m0 xfb h14 ydcf ff12 fs7 fcb sc0 ls10c ws0">up.</div></div><div class="c x10f yf2b w6c hd9"><div class="t m0 x42 h14 yf2c ff12 fs7 fcb sc0 ls6 ws0">C<span class="ff13">r</span><span class="lsff ws38b">eates the book</span><span class="ff13">m</span>a<span class="ff13">r</span><span class="ls14e">ks </span></div><div class="t m0 x42 h14 yf2d ff12 fs7 fcb sc0 lsdc ws3df">table with the <span class="ff13 ls6 ws0">n<span class="ff12 lsee">ecessa</span>r<span class="ff12 lsd3">y </span></span></div><div class="t m0 x42 h14 y936 ff12 fs7 fcb sc0 lsd6 ws0">colu<span class="ff13 ls10e">mn<span class="ff12 ws4f1">s a</span><span class="ls6">n</span></span><span class="lsde ws2ad">d co</span><span class="ff13 ls6">n</span><span class="ls10e">st<span class="ff13 ls6">r</span><span class="ls122">ai<span class="ff13 ls6">n</span><span class="lsd2">ts</span></span></span></div></div><div class="t m0 x19 h32 yce5 ff4 fs1b fcd sc0 ls6 ws0">3</div><div class="t m0 x34 h33 y981 ff4 fs17 fcd sc0 ls6 ws0">See <span class="_ _f"></span>Wikipedia’s <span class="_ _f"></span>article <span class="_ _f"></span>on <span class="_ _e"></span>“ISO<span class="_ _e"></span> <span class="_ _e"></span>8601” <span class="_ _f"></span>for</div><div class="t m3 x0 h34 y981 ff8 fs17 fcd sc0 ls6 ws0"> </div><div class="t m0 x47 h33 y981 ff4 fs17 fcd sc0 ls6 ws0">more <span class="_ _f"></span>information <span class="_ _f"></span>on <span class="_ _e"></span>t<span class="_ _e"></span>his <span class="_ _e"></span>time <span class="_ _f"></span>format:</div><div class="t m3 x0 h34 y981 ff8 fs17 fcd sc0 ls6 ws0"> </div><div class="t m0 x73 h33 y981 ff4 fs17 fcf sc0 ls6 ws0">https://en.wi<span class="_ _e"></span>kipedia.org/</div><div class="t m0 x34 h33 y211 ff4 fs17 fcf sc0 ls6 ws0">wiki/ISO_8601<span class="_ _e"></span><span class="fcd">.</span></div><a class="l" href="https://en.wikipedia.org/wiki/ISO_8601"><div class="d m2" style="border-style:none;position:absolute;left:377.040000px;bottom:71.918000px;width:97.080000px;height:10.380000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="https://en.wikipedia.org/wiki/ISO_8601"><div class="d m2" style="border-style:none;position:absolute;left:474.120000px;bottom:71.918000px;width:0.180000px;height:10.380000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="https://en.wikipedia.org/wiki/ISO_8601"><div class="d m2" style="border-style:none;position:absolute;left:66.120000px;bottom:61.718000px;width:58.920000px;height:10.200000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
