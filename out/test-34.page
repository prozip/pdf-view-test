<div id="pf22" class="pf w0 h0" data-page-no="22"><div class="pc pc22 w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg22.png"/><div class="t m0 x42 h14 y80 ff7 fs7 fcb sc0 ls6 ws0">10</div><div class="t m0 xa8 h2b y1cf ffb fs18 fcb sc0 ls6 ws0">C</div><div class="t m0 xb6 h2c y1d0 ffb fs19 fcb sc0 ls8b ws0">HAPTER</div><div class="t m0 x1f h2b y1cf ffb fs18 fcb sc0 ls8c ws0"> 1</div><div class="t m0 xb3 h2d y80 ffa fs7 fcb sc0 ls6 ws0">The bigger picture</div><div class="t m0 x44 h26 y1e4 ffc fs15 fc2 sc0 lsbe ws223">Organically grown software<span class="_ _30"></span>1<span class="_ _0"></span>.<span class="_ _1d"></span>4.<span class="_ _0"></span>2</div><div class="t m0 x44 h15 y140 ff4 fsb fc3 sc0 ls48 ws224">Unlike the produce at your local farmers’<span class="ls71 ws21a"> market, organically <span class="_ _e"></span>grown software is not</span></div><div class="t m0 x44 h15 y141 ff4 fsb fc3 sc0 ls5f ws95">good for your health. In the<span class="_ _0"></span> context of so<span class="ls2f wse2">ftware, a system that has grown organically</span></div><div class="t m0 x44 h15 y142 ff4 fsb fc3 sc0 ls42 ws8c">over time is likely a system ripe for <span class="ff3 ls25 ws0">refactoring</span><span class="ls1e ws225">. Refactoring<span class="_ _0"></span> code is the process of updat-</span></div><div class="t m0 x44 h15 y143 ff4 fsb fc3 sc0 ls6c ws226">ing code so it<span class="_ _0"></span>’s better designed <span class="_ _0"></span>and reflects <span class="_ _0"></span><span class="ls38 ws227">your latest best practices. It might involve</span></div><div class="t m0 x44 h15 y144 ff4 fsb fc3 sc0 ls38 ws23">improving the performance, maintainability, or readability of code.</div><div class="t m0 x32 h15 y145 ff4 fsb fc3 sc0 ls35 ws228"> As the term suggests, organically grow<span class="_ _0"></span><span class="ls51 ws229">n software has become an organism, com-</span></div><div class="t m0 x44 h15 y146 ff4 fsb fc3 sc0 ls3a ws22a">plete with a nervous system <span class="ws112">and a mind of its own. Bits of other software may have</span></div><div class="t m0 x44 h15 y24e ff4 fsb fc3 sc0 ls3b ws22b">been plastered onto <span class="_ _e"></span>it (usually more than<span class="ls3a ws74"> once), methods that haven’t been <span class="_ _e"></span>used in</span></div><div class="t m0 x44 h15 yb6 ff4 fsb fc3 sc0 ls36 ws22c">years are in there somewher<span class="ls20 ws22d">e, rotting, and maybe there’s one function that does</span></div><div class="t m0 x44 h15 y8b ff4 fsb fc3 sc0 ls30 ws22e">about 150% of the work. Choosing when to re<span class="ls66 ws22f">factor a system like this can be<span class="_ _0"></span> difficult,</span></div><div class="t m0 x44 h15 y26c ff4 fsb fc3 sc0 ls7d ws12a">but it’s sometime before <span class="_ _e"></span>the moment<span class="ls42 ws32"> that makes you yell, “It’s alive!”</span></div><div class="t m0 x32 h15 y26d ff4 fsb fc3 sc0 ls1f ws7f"> An example of this phenomenon is shown <span class="_ _0"></span>in figure 1.3,<span class="_ _0"></span> which depicts the check-</div><div class="t m0 x44 h15 y26e ff4 fsb fc3 sc0 ls3a ws28">out process for an e-comme<span class="ls20 ws51">rce site. It involves <span class="_ _e"></span><span class="ls2f ws23">several important steps:</span></span></div><div class="t m0 x86 h3d y26f ffb fs1e fca sc0 ls6 ws0">1</div><div class="t m0 x87 h15 y270 ff4 fsb fc3 sc0 ls51 ws47">Determine that the product is available in the inventory.</div><div class="t m0 x86 h3d y271 ffb fs1e fca sc0 ls6 ws0">2</div><div class="t m0 x87 h15 y272 ff4 fsb fc3 sc0 ls50 ws41">Based on the price of the product, cal<span class="_ _0"></span>culate the subtotal.</div><div class="t m0 x86 h3d y273 ffb fs1e fca sc0 ls6 ws0">3</div><div class="t m0 x87 h15 y274 ff4 fsb fc3 sc0 ls3a ws1e0">Based on the region of purchase, calculate:</div><div class="t m0 x87 h3d y275 ffb fs1e fca sc0 ls6 ws0">a</div><div class="t m0 x20 h15 y276 ff4 fsb fc3 sc0 ls44 ws0">Tax</div><div class="t m0 x87 h3d y277 ffb fs1e fca sc0 ls6 ws0">b</div><div class="t m0 x20 h15 y96 ff4 fsb fc3 sc0 ls34 ws22">Shipping and handling</div><div class="t m0 x86 h3d y278 ffb fs1e fca sc0 ls6 ws0">4</div><div class="t m0 x87 h15 y54 ff4 fsb fc3 sc0 ls30 ws36">Based on the current promotio<span class="_ _e"></span>ns, calculate any discounts.</div><div class="t m0 x86 h3d y279 ffb fs1e fca sc0 ls6 ws0">5</div><div class="t m0 x87 h15 yc8 ff4 fsb fc3 sc0 ls44 ws34">Calculate the final total.</div><div class="t m0 x86 h3d y27a ffb fs1e fca sc0 ls6 ws0">6</div><div class="t m0 x87 h15 y27b ff4 fsb fc3 sc0 ls3a ws1e0">Process the payment.</div><div class="t m0 x86 h3d y27c ffb fs1e fca sc0 ls6 ws0">7</div><div class="t m0 x87 h15 y27d ff4 fsb fc3 sc0 ls25 ws1e1">Fulfill the order.</div><div class="t m0 x44 h15 y27e ff4 fsb fc3 sc0 ls36 ws230">In this system, some of the steps are separa<span class="ls5e ws231">ted clearly. Not <span class="_ _e"></span>bad! But there is a rough</span></div><div class="t m0 x44 h15 y1ac ff4 fsb fc3 sc0 ls3d ws232">patch in the middle. It looks like all of th<span class="ls25 ws233">e price-related logic happens in one big chunk.</span></div><div class="t m0 x44 h15 y1ad ff4 fsb fc3 sc0 ls50 ws234">If there’s a bug in that process, it migh<span class="_ _0"></span>t be difficult to under<span class="_ _0"></span>stand exactly <span class="ff3 ls44 ws0">which</span><span class="ls38 ws110"> step con-</span></div><div class="t m0 x44 h15 y1ae ff4 fsb fc3 sc0 ls42 ws1f2">tains the bug. You may see that the<span class="_ _e"></span> price is wrong, but there will be a lot o<span class="_ _e"></span>f code to sift</div><div class="t m0 x44 h15 y1af ff4 fsb fc3 sc0 ls20 ws235">through to figure out why. The payment pr<span class="ls1e ws236">ocessing and fulfillme<span class="ls1c ws151">nt are also lumped</span></span></div><div class="c x44 y27f w6 h3e"><div class="t m0 xbc h36 y280 ff11 fs1c fc12 sc0 ls6 ws0">Check inventory</div><div class="t m0 x8b h36 y281 ff11 fs1c fc12 sc0 ls6 ws0">Calculate</div><div class="t m0 xae h36 y282 ff11 fs1c fc12 sc0 ls6 ws0">cart subtotal,</div><div class="t m0 xae h36 y283 ff11 fs1c fc12 sc0 ls6 ws0">tax, shipping,</div><div class="t m0 x8a h36 y284 ff11 fs1c fc12 sc0 ls6 ws0">discounts,</div><div class="t m0 x8b h36 y285 ff11 fs1c fc12 sc0 ls6 ws0">final total</div><div class="t m0 x32 h36 y286 ff11 fs1c fc12 sc0 ls6 ws0">Process payment</div><div class="t m0 x83 h36 y287 ff11 fs1c fc12 sc0 ls6 ws0">and send to</div><div class="t m0 x8b h36 y288 ff11 fs1c fc12 sc0 ls6 ws0">fulfillment</div><div class="t m0 xbb h36 y289 ff11 fs1c fc12 sc0 ls6 ws0">Customer</div><div class="t m0 xbd h36 y28a ff11 fs1c fc12 sc0 ls6 ws0">Checkout</div><div class="t m0 xbe h37 y28b ff12 fs1d fc12 sc0 ls6 ws0">This area handles a lot of logic!</div><div class="t m0 xbe h37 y28c ff12 fs1d fc12 sc0 ls6 ws0">What happens when the payment</div><div class="t m0 xbe h37 y28d ff12 fs1d fc12 sc0 ls6 ws0">succeeds but fulfillment fails?</div></div><div class="t m0 x44 h2b y28e ffb fs18 fc11 sc0 ls6 ws0">Figure 1.3</div><div class="t m3 x0 h3a y28e ff8 fs18 fc11 sc0 ls6 ws0"> </div><div class="t m0 x3d h2b y28e ffb fs18 fc11 sc0 ls6 ws0">An e-commerce system tha<span class="_ _e"></span>t grew organically</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
