<div id="pf83" class="pf w0 h0" data-page-no="83"><div class="pc pc83 w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg83.png"/><div class="t m0 xa0 h14 y80 ff7 fs7 fcb sc0 ls6 ws0">107<span class="_ _aa"></span><span class="ffa">An initial code structure, by concern</span></div><div class="t m0 x35 h26 yd2e ffc fs15 fc2 sc0 ls183 ws5da">The persistence layer<span class="_ _48"></span>6<span class="_ _1d"></span>.3<span class="_ _0"></span>.<span class="_ _1d"></span>1</div><div class="t m0 x35 h15 y345 ff4 fsb fc3 sc0 ls70 ws6d7">The persisten<span class="_ _e"></span>ce layer is the lowest level o<span class="_ _e"></span>f Bark (figure 6.3).</div><div class="t m0 x35 h15 y5c0 ff4 fsb fc3 sc0 ls70 ws6d8">This layer will be c<span class="_ _e"></span>oncerne<span class="ls44 ws6d9">d with taking information it</span></div><div class="t m0 x35 h15 y5c1 ff4 fsb fc3 sc0 ls62 ws278">receives and <span class="_ _e"></span>communicating<span class="ls79 wsf6"> it to the <span class="_ _e"></span>database.</span></div><div class="t m0 x83 h15 y5c2 ff4 fsb fc3 sc0 ls2d ws7c"> You’ll be using SQLite, a portable database that stores</div><div class="t m0 x35 h15 y72e ff4 fsb fc3 sc0 ls6f ws3b4">data in a single<span class="_ _e"></span> file by default (<span class="fcc ls21 ws0">www.sqlite.org/index.html<span class="_ _0"></span><span class="fc3 ls15f">).</span></span></div><div class="t m0 x35 h15 y72f ff4 fsb fc3 sc0 ls36 ws6da">This is convenient, compared to more complex database</div><div class="t m0 x35 h15 y731 ff4 fsb fc3 sc0 ls42 ws1ec">systems, because you can start <span class="ls71 ws1cb">from scratch by deleting the</span></div><div class="t m0 x35 h15 y732 ff4 fsb fc3 sc0 ls20 ws51">file if someth<span class="ls80 wsff">ing goes wr<span class="_ _e"></span>ong.</span></div><div class="t m0 x83 h49 yd2f ffb fs17 fc2 sc0 lsf7 ws0">NOTE</div><div class="t m0 xaf h15 yc6f ff4 fsb fc3 sc0 ls51 ws6db">Despite being one of the most widely used</div><div class="t m0 x83 h15 y199 ff4 fsb fc3 sc0 ls38 ws591">databases, SQLite is instal<span class="ws1c8">led on only some operat-</span></div><div class="t m0 x83 h15 y472 ff4 fsb fc3 sc0 ls51 ws1bb">ing systems by default. <span class="ls2f ws81">I recommend <span class="ls7d ws0">downloading</span></span></div><div class="t m0 x83 h15 y1fd ff4 fsb fc3 sc0 ls50 ws6dc">a precompiled binary for your operati<span class="_ _0"></span>ng system</div><div class="t m0 x83 h15 yf5 ff4 fsb fc3 sc0 ls1c ws6dd">from the official download page (<span class="fcc ls2d ws0">https://sqlite</span></div><div class="t m0 x83 h15 yf7 ff4 fsb fcc sc0 ls79 ws0">.org/downloa<span class="_ _e"></span>d.html<span class="fc3">).</span></div><div class="t m0 x35 h15 y15b ff4 fsb fc3 sc0 ls36 ws33b">Starting in the database module, you’ll<span class="_ _0"></span> create a </div><div class="t m5 x52 h24 yd30 ffd fsc fc3 sc0 lsa0 ws0">Database-</div><div class="t m5 x35 h24 yd31 ffd fsc fc3 sc0 lsa0 ws0">Manager</div><div class="t m0 xd8 h15 y9e ff4 fsb fc3 sc0 ls66 wsb3"> class for manipulati<span class="_ _0"></span>ng data in the datab<span class="_ _0"></span>ase. Python prov<span class="_ _0"></span>ides a built-in sql<span class="_ _0"></span>ite3</div><div class="t m0 x35 h15 yae9 ff4 fsb fc3 sc0 ls1e ws4a6">module, which you can use to get a connection<span class="ls30 ws23c"> <span class="_ _0"></span>to the database, make queries, and iter-</span></div><div class="t m0 x35 h15 yd32 ff4 fsb fc3 sc0 ls34 wsbe">ate over results. SQLite databases are usually <span class="ls36 ws230">a single file with a <span class="ls2f wse2">.db extension; if you</span></span></div><div class="t m0 x35 h15 yd33 ff4 fsb fc3 sc0 ls2f ws23">make a sqlite3 connection to a <span class="ls5e ws62d">file that doesn’t exist, the module will create <span class="_ _e"></span>it for you.</span></div><div class="t m0 x83 h15 y11c ff4 fsb fc3 sc0 ls1e wsb4"> The database module provides most of <span class="_ _0"></span><span class="ls3e ws6de">what you need to manage bookmark data,</span></div><div class="t m0 x35 h15 y714 ff4 fsb fc3 sc0 ls38 ws26">including the following:</div><div class="t m0 x8b h29 yd34 ffe fs17 fca sc0 ls6 ws0"></div><div class="t m0 x48 h15 y297 ff4 fsb fc3 sc0 ls30 ws36">Creating a table (for initializing the <span class="_ _e"></span>database)</div><div class="t m0 x8b h29 yd35 ffe fs17 fca sc0 ls6 ws0"></div><div class="t m0 x48 h15 y209 ff4 fsb fc3 sc0 ls42 ws26e">Adding or deleting a record</div><div class="t m0 x8b h29 yd36 ffe fs17 fca sc0 ls6 ws0"></div><div class="t m0 x48 h15 y136 ff4 fsb fc3 sc0 ls1e ws13">Listing the records in a <span class="_ _0"></span>table</div><div class="t m0 x8b h29 yd37 ffe fs17 fca sc0 ls6 ws0"></div><div class="t m0 x48 h15 yd38 ff4 fsb fc3 sc0 lsf8 ws434">Selecting<span class="_ _e"></span> and sorting reco<span class="_ _e"></span>rds from<span class="ls67 ws6c"> a table based on<span class="ls34 ws22"> some criteria</span></span></div><div class="t m0 x8b h29 yd39 ffe fs17 fca sc0 ls6 ws0"></div><div class="t m0 x48 h15 y7c1 ff4 fsb fc3 sc0 ls30 ws36">Counting the number of reco<span class="_ _e"></span>rds in a table</div><div class="t m0 x35 h15 yd3a ff4 fsb fc3 sc0 ls48 ws364">How can these tasks be broken down furt<span class="ls71 ws21a">her? Each seems som<span class="_ _e"></span>ewhat separate, from</span></div><div class="t m0 x35 h15 yd3b ff4 fsb fc3 sc0 ls2d ws6df">the business logic perspective described ear<span class="_ _0"></span><span class="ls38 ws460">lier, but what about <span class="ls50 ws6e0">at the persistence</span></span></div><div class="t m0 x35 h15 yd3c ff4 fsb fc3 sc0 ls20 ws40a">layer? Most of the activities described can <span class="ls2e ws6e1">be achieved by constr<span class="lsb1 ws44b">ucting an approp<span class="_ _0"></span>riate</span></span></div><div class="c x35 yd3d w2 hc4"><div class="t m0 xb7 h2f yd3e ffb fs15 fc2 sc0 ls1a8 ws6e2">Applicatio<span class="_ _0"></span>n architectu<span class="_ _0"></span>re patterns</div><div class="t m0 xb7 h30 yd3f fff fsc fc3 sc0 ls165 ws6e3">Separating applications into laye<span class="_ _e"></span>rs of pres<span class="ls94 ws6e4">entation, pe<span class="_ _e"></span>rsistence, and actions or rule<span class="_ _e"></span>s</span></div><div class="t m0 xb7 h30 yd40 fff fsc fc3 sc0 lsb9 ws6e5">is a common pa<span class="_ _0"></span>ttern. Some va<span class="_ _0"></span>riations on th<span class="_ _0"></span>is approach ar<span class="_ _0"></span>e so common, they<span class="_ _0"></span>’ve been</div><div class="t m0 xb7 h30 yd41 fff fsc fc3 sc0 ls94 ws6e6">given names. <span class="ff10 lsd0 ws0">Model-vie<span class="_ _e"></span>w-controller </span><span class="lscc ws6e7">(MVC) is a way of <span class="ff10 ls16a ws0">modeling</span><span class="ls1a9 ws6e8"> da<span class="_ _e"></span>ta for persistence,</span></span></div><div class="t m0 xb7 h30 yd42 fff fsc fc3 sc0 lscf ws6e9">providing users<span class="_ _0"></span> with a </div><div class="t m0 xff h1b yd43 ff3 fsb fc3 sc0 ls34 ws0">view</div><div class="t m0 xd7 h30 yd42 fff fsc fc3 sc0 ls17d ws6ea"> into that da<span class="_ _0"></span>ta, and allowi<span class="_ _0"></span>ng them to <span class="_ _0"></span><span class="ff10 ls157 ws0">control<span class="fff lsc ws6eb"> changes to</span></span></div><div class="t m0 xb7 h30 yd44 fff fsc fc3 sc0 lsf ws6ec">that data with some set of actions. <span class="ff10 ls16a ws0">Model-view-vi<span class="_ _e"></span>ewmodel <span class="_ _1d"></span><span class="fff ls1aa ws6ed">(MVVM) puts an em<span class="_ _0"></span>phasis</span></span></div><div class="t m0 xb7 h30 yd45 fff fsc fc3 sc0 ls94 ws6ee">on allowing the <span class="_ _e"></span>view and data model <span class="ls189 ws6ef">to commu<span class="_ _e"></span>nicate freely. These and other <span class="ff10 lsca ws0">multitier</span></span></div><div class="t m0 xb7 h30 yd46 ff10 fsc fc3 sc0 ls17e ws0">architectures<span class="_ _e"></span><span class="fff ls99 ws6f0"> are gre<span class="_ _0"></span>at examples of se<span class="_ _0"></span>paration of concer<span class="_ _0"></span>ns.</span></div></div><div class="c x6f yd47 w5b hc5"><div class="t m0 xf4 h36 yd48 ff11 fs1c fc12 sc0 ls6 ws0">Presentation layer</div><div class="t m0 xf3 h36 yd49 ff11 fs1c fc12 sc0 ls6 ws0">Business logic layer</div><div class="t m0 xf9 h36 yd4a ff11 fs1c fc12 sc0 ls6 ws0">Persistence layer</div></div><div class="c xcc yd4b w4f hc6"><div class="t m0 xb7 h2b yd4c ffb fs18 fcb sc0 ls12e ws6f1">Figure 6.3<span class="_ _29"> </span>The persistence </div><div class="t m0 xb7 h2b yd4d ffb fs18 fcb sc0 ls143 ws526">layer deals with data </div><div class="t m0 xb7 h2b yd4e ffb fs18 fcb sc0 ls143 ws526">storage—it’s the lowest </div><div class="t m0 xb7 h2b yd4f ffb fs18 fcb sc0 ls12e ws493">level of the application.</div></div><a class="l" href="https://sqlite.org/download.html"><div class="d m2" style="border-style:none;position:absolute;left:277.140000px;bottom:292.478000px;width:58.980000px;height:11.280000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="https://sqlite.org/download.html"><div class="d m2" style="border-style:none;position:absolute;left:109.725000px;bottom:280.478000px;width:93.555000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="https://www.sqlite.org/index.html"><div class="d m2" style="border-style:none;position:absolute;left:237.180000px;bottom:400.478000px;width:115.920000px;height:11.280000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
