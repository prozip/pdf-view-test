<div id="pf8b" class="pf w0 h0" data-page-no="8b"><div class="pc pc8b w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg8b.png"/><div class="t m0 xa0 h14 y80 ff7 fs7 fcb sc0 ls6 ws0">115<span class="_ _aa"></span><span class="ffa">An initial code structure, by concern</span></div><div class="t m0 x35 h15 y40 ff4 fsb fc3 sc0 ls30 ws36">Additionally, you can sort these resu<span class="ls34 ws22">lts by a specific column using an </span></div><div class="t m5 x6 h24 y3eb ffd fsc fc3 sc0 lsa0 ws745">ORDER BY</div><div class="t m0 xda h15 y40 ff4 fsb fc3 sc0 lsbc ws1ff"> clause:</div><div class="t m0 x15 h3b yeb0 ffd fs18 fc3 sc0 lsb2 ws0">FROM<span class="_"> </span>bookmarks<span class="_ _6d"></span>*<span class="_ _6e"></span>SELECT</div><div class="t m0 x8c h3b yeb1 ffd fs18 fc3 sc0 lsb2 ws0">3<span class="_ _85"></span>=<span class="_ _46"></span>ID<span class="_ _6e"></span>WHERE</div><div class="t m0 x35 h3b yeb2 ffd fs18 fc1 sc0 lsb2 ws0">ORDER<span class="_"> </span>BY<span class="_"> </span>title<span class="fc3 ls6">;</span></div><div class="t m0 x35 h15 yd0a ff4 fsb fc3 sc0 ls25 ws1a">Again, you should use placeholders wher<span class="ls20 ws51">e there are literal values in the query:</span></div><div class="t m0 x35 h3b y50e ffd fs18 fc3 sc0 lsb2 ws0">SELECT<span class="_"> </span>*<span class="_"> </span>FROM<span class="_"> </span>bookmarks</div><div class="t m0 x35 h3b y510 ffd fs18 fc3 sc0 lsb2 ws0">WHERE<span class="_"> </span>ID<span class="_"> </span>=<span class="_"> </span>?</div><div class="t m0 x35 h3b y511 ffd fs18 fc1 sc0 lsb2 ws0">ORDER<span class="_"> </span>BY<span class="_"> </span>title;</div><div class="t m0 x35 h15 y89 ff4 fsb fc3 sc0 ls52 ws0">Your </div><div class="t m5 x4 h24 yeb3 ffd fsc fc3 sc0 lsa0 ws0">select</div><div class="t m0 x37 h15 y89 ff4 fsb fc3 sc0 ls3a ws20e"> method will look somewhat similar to the </div><div class="t m5 x5b h24 yeb3 ffd fsc fc3 sc0 lsa0 ws0">delete</div><div class="t m0 x33 h15 y89 ff4 fsb fc3 sc0 ls31 ws2b7"> method, except that</div><div class="t m5 x35 h24 yeb4 ffd fsc fc3 sc0 lsa0 ws0">criteria</div><div class="t m0 x79 h15 yeb5 ff4 fsb fc3 sc0 ls80 wsd9"> can be optional. (It will fetch all record<span class="_ _e"></span><span class="ls51 ws12d">s by default.) It should also accept an</span></div><div class="t m0 x35 h15 yeb6 ff4 fsb fc3 sc0 ls2f ws0">optional </div><div class="t m5 x79 h24 yeb7 ffd fsc fc3 sc0 lsa0 ws0">order_by</div><div class="t m0 xd1 h15 yeb6 ff4 fsb fc3 sc0 ls2f ws26a"> argument that specifies a column to<span class="ls34 ws9f"> <span class="_ _0"></span>sort the results by (the default</span></div><div class="t m0 x35 h15 yad6 ff4 fsb fc3 sc0 ls3b ws4b0">is the primary key of the table). Using </div><div class="t m5 x4e h24 yeb8 ffd fsc fc3 sc0 lsa0 ws0">delete</div><div class="t m0 x2e h15 yad6 ff4 fsb fc3 sc0 ls31 wsc6"> as a guide, write </div><div class="t m5 x73 h24 yeb8 ffd fsc fc3 sc0 lsa0 ws0">select</div><div class="t m0 xd4 h15 yad6 ff4 fsb fc3 sc0 ls1c ws4af"> now and come</div><div class="t m0 x35 h15 yeb9 ff4 fsb fc3 sc0 ls7d ws11c">back to compare with the follow<span class="ls38 ws1f4">ing listing when you’re done.</span></div><div class="t m0 x35 h3b yeba ffd fs18 fc3 sc0 lsb2 ws0">def<span class="_"> </span>select(self,<span class="_"> </span>table_name,<span class="_"> </span>criteria=None,<span class="_"> </span>order_by=None):</div><div class="t m0 x36 h3b yebb ffd fs18 fc3 sc0 lsb2 ws0">criteria<span class="_"> </span>=<span class="_"> </span>criteria<span class="_"> </span>or<span class="_"> </span>{}</div><div class="t m0 x36 h3b yebc ffd fs18 fc3 sc0 lsb2 ws0">query<span class="_"> </span>=<span class="_"> </span>f&apos;SELECT<span class="_"> </span>*<span class="_"> </span>FROM<span class="_"> </span>{table_name}&apos;</div><div class="t m0 x36 h3b yebd ffd fs18 fc3 sc0 lsb2 ws0">if<span class="_"> </span>criteria:</div><div class="t m0 xe6 h3b yebe ffd fs18 fc3 sc0 lsb2 ws0">placeholders<span class="_"> </span>=<span class="_"> </span>[f&apos;{column}<span class="_"> </span>=<span class="_"> </span>?&apos;<span class="_"> </span>for<span class="_"> </span>column<span class="_"> </span>in<span class="_"> </span>criteria.keys()]</div><div class="t m0 xe6 h3b yebf ffd fs18 fc3 sc0 lsb2 ws0">select_criteri<span class="lsfb">a=&apos;A<span class="_ _3a"></span>N<span class="_ _7"></span>D<span class="lsb2">&apos;.join(placeholders)</span></span></div><div class="t m0 xe6 h3b yec0 ffd fs18 fc3 sc0 lsb2 ws0">query<span class="_"> </span>+=<span class="_"> </span>f&apos;<span class="_"> </span>WHERE<span class="_"> </span>{select_criteria}&apos;</div><div class="t m0 x36 h3b yec1 ffd fs18 fc3 sc0 lsb2 ws0">if<span class="_"> </span>order_by:</div><div class="t m0 xe6 h3b yec2 ffd fs18 fc3 sc0 lsb2 ws0">query<span class="_"> </span>+=<span class="_"> </span>f&apos;<span class="_"> </span>ORDER<span class="_"> </span>BY<span class="_"> </span>{order_by}&apos;</div><div class="t m0 x36 h3b yec3 ffd fs18 fc3 sc0 lsb2 ws0">return<span class="_"> </span>self._execute(</div><div class="t m0 xe6 h3b yec4 ffd fs18 fc3 sc0 lsb2 ws0">query,</div><div class="t m0 xe6 h3b yec5 ffd fs18 fc3 sc0 lsb2 ws0">tuple(criteria.values()),</div><div class="t m0 x36 h3b yec6 ffd fs18 fc1 sc0 ls6 ws0">)</div><div class="t m0 x35 h15 yec7 ff4 fsb fc3 sc0 ls7d ws746">You’ve now created a database<span class="_ _e"></span> connection; written an </div><div class="t m5 xa2 h24 yec8 ffd fsc fc3 sc0 lsa0 ws0">_execute</div><div class="t m0 x73 h15 yec7 ff4 fsb fc3 sc0 ls34 ws3a8"> method for executing</div><div class="t m0 x35 h15 yec9 ff4 fsb fc3 sc0 ls2d ws5a0">arbitrary SQL statements with<span class="ls2f ws81"> placeholders in a transact<span class="ls3e ws747">ion; and written methods to</span></span></div><div class="t m0 x35 h15 yeca ff4 fsb fc3 sc0 ls3e ws1b3">add, query, and delete records. This is ab<span class="ls81 ws29b">out all you’ll need for manipu<span class="_ _e"></span>lating a SQLite</span></div><div class="t m0 x35 h15 yecb ff4 fsb fc3 sc0 ls71 ws404">database for the moment. You just finished<span class="ls34"> a database manager in fewer than 100</span></div><div class="t m0 x35 h15 yecc ff4 fsb fc3 sc0 lsae ws418">lines of code<span class="_ _0"></span>. Nice work.</div><div class="t m0 x83 h15 yecd ff4 fsb fc3 sc0 ls2d ws31"> Next, you’ll develop the business logic that<span class="ls30 ws36"> interacts with the persistence layer. </span></div><div class="t m0 x19 h26 yece ffc fs15 fc2 sc0 ls1c3 ws748">6<span class="_ _0"></span>.<span class="_ _1d"></span>3.<span class="_ _1d"></span>2<span class="_ _5f"> </span>The business logic la<span class="_ _0"></span>yer</div><div class="t m0 x35 h15 yecf ff4 fsb fc3 sc0 ls2d ws177">Now that the persistence layer for Bark is in place, you can work on the layer that fig-</div><div class="t m0 x35 h15 yed0 ff4 fsb fc3 sc0 ls5e ws14a">ures out what to put in and <span class="_ _e"></span>get out of the persistence layer (figure<span class="_ _e"></span> 6.7).</div><div class="t m0 x83 h15 yed1 ff4 fsb fc3 sc0 ls30 ws12c"> When a user interacts with som<span class="_ _e"></span>ething in <span class="ls1c wsf2">the presentation layer of Bark, Bark needs</span></div><div class="t m0 x35 h15 yed2 ff4 fsb fc3 sc0 ls3a ws1e0">to trigger something to happen in the busine<span class="ls38 ws1f4">ss logic and ultimately in the persistence</span></div><div class="t m0 x17 h20 yed3 ffb fs7 fc4 sc0 ls6 ws0">A method for selecting SQL table data<span class="_ _8c"></span>Listing<span class="_"> </span>6.5</div><div class="c x3a yed4 w9 h56"><div class="t m0 x12e h14 yb49 ff12 fs7 fcb sc0 ls164 ws70f">This o<span class="ff13 ls6 ws0">r<span class="ff12 lsec">de</span>r</span><span class="ls170 ws749">s the <span class="ff13 ls6 ws0">r</span><span class="lsff ws38b">esults by the tit<span class="_ _0"></span>le </span></span></div><div class="t m0 x12e h14 y480 ff12 fs7 fcb sc0 lsed ws0">colu<span class="ff13 ls10e">mn</span><span class="lse1"> i<span class="ff13 ls6">n</span><span class="ls14e ws74a"> asce</span><span class="ff13 ls6">n</span><span class="lsec">di<span class="ff13 ls6">n</span></span><span class="ws74b">g o</span><span class="ff13 ls6">r</span><span class="lsec">de<span class="ff13 ls6">r<span class="ff12">.</span></span></span></span></div></div><div class="c x98 yed5 w3e hd4"><div class="t m0 x42 h14 y7c9 ff12 fs7 fcb sc0 ls6 ws0">C<span class="ff13">r</span><span class="ls100">ite</span><span class="ff13">r</span><span class="ls122 ws4f9">ia ca</span><span class="ff13">n<span class="_ _0"></span><span class="ff12 lsfd ws31a"> be e<span class="ff13 ls6 ws0">m</span><span class="lsff ws38b">pty by default, </span></span></span></div><div class="t m0 x42 h14 y7ca ff12 fs7 fcb sc0 lsde ws2ad">because selecti<span class="ff13 ls6 ws0">n</span><span class="ls1b2 ws5c5">g all <span class="ff13 ls6 ws0">r<span class="ff12">eco</span>r</span><span class="ls105 ws327">ds i<span class="ff13 ls6 ws0">n<span class="ff12"> </span></span></span></span></div><div class="t m0 x42 h14 y7cb ff12 fs7 fcb sc0 lsde ws2ad">the table is all <span class="ff13 ls6 ws0">r<span class="ff12 ls114">ight.</span></span></div></div><div class="c x43 yed6 w62 hd5"><div class="t m0 x124 h14 yed7 ff12 fs7 fcb sc0 lsd2 ws0">Co<span class="ff13 ls6">n</span><span class="ls119">st<span class="ff13 ls6">r</span><span class="lsec">ucts</span></span></div><div class="t m0 xf9 h14 yed8 ff12 fs7 fcb sc0 lsff ws315">the WHERE</div><div class="t m0 xfd h14 yed9 ff12 fs7 fcb sc0 lsda ws2aa">clause to</div><div class="t m0 xfd h14 yeda ff12 fs7 fcb sc0 ls6 ws0">li<span class="ff13">m</span><span class="lsd4 ws4ee">it the</span></div><div class="t m0 x134 h14 yedb ff13 fs7 fcb sc0 ls6 ws0">r<span class="ff12 ls10a">esults</span></div></div><div class="c x43 yedc w62 hd6"><div class="t m0 x124 h14 ye00 ff12 fs7 fcb sc0 lsd2 ws0">Co<span class="ff13 ls6">n</span><span class="ls119">st<span class="ff13 ls6">r</span><span class="lsec">ucts</span></span></div><div class="t m0 xdf h14 yedd ff12 fs7 fcb sc0 ls105 ws325">the ORDER</div><div class="t m0 xf4 h14 ye02 ff12 fs7 fcb sc0 lsff ws38b">BY clause to</div><div class="t m0 x128 h14 yede ff12 fs7 fcb sc0 ls10e ws0">so<span class="ff13 ls6">r</span><span class="ls10c ws3d9">t the</span></div><div class="t m0 x134 h14 yedf ff13 fs7 fcb sc0 ls6 ws0">r<span class="ff12 ls10a">esults</span></div></div><div class="c x6b yee0 w67 h43"><div class="t m0 xea h14 y2f5 ff12 fs7 fcb sc0 ls106 ws74c">This ti<span class="ff13 ls6 ws0">m</span><span class="ls117 ws74d">e, you<span class="_ _e"></span> wa<span class="ff13 ls6 ws0">n</span><span class="ls146 ws598">t the <span class="ff13 ls6 ws0">r<span class="ff12 ls105">etu</span><span class="ls123">rn</span></span><span class="lsd5 ws74e"> value f<span class="ff13 ls6 ws0">r<span class="ff12">o</span>m<span class="ff12"> </span></span></span></span></span></div><div class="t m0 xea h14 y2f7 ff12 fs7 fcb sc0 lsde ws3cf">_execute to ite<span class="ff13 ls6 ws0">r<span class="ff12 ws317">ate ove</span>r</span><span class="lsda ws2aa"> the <span class="ff13 ls6 ws0">r<span class="ff12 ls11a">esults.</span></span></span></div></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
