<div id="pf8e" class="pf w0 h0" data-page-no="8e"><div class="pc pc8e w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg8e.png"/><div class="t m0 x42 h14 y80 ff7 fs7 fcb sc0 ls6 ws0">118</div><div class="t m0 x66 h2b y1cf ffb fs18 fcb sc0 ls6 ws0">C</div><div class="t m0 x8e h2c y1d0 ffb fs19 fcb sc0 ls185 ws0">HAPTER</div><div class="t m0 xf1 h2b y1cf ffb fs18 fcb sc0 ls8c ws0"> 6</div><div class="t m0 xe4 h2d y80 ffa fs7 fcb sc0 ls6 ws0">Separation of concerns in practice</div><div class="t m0 x44 h3b yf2e ffd fs18 fc3 sc0 lsb2 ws0">class<span class="_"> </span>AddBookmarkCommand:</div><div class="t m0 xae h3b yf2f ffd fs18 fc3 sc0 lsb2 ws0">def<span class="_"> </span>execute(self,<span class="_"> </span>data):</div><div class="t m0 x97 h3b yf30 ffd fs18 fc3 sc0 lsb2 ws0">data[&apos;date_added&apos;]<span class="_"> </span>=<span class="_"> </span>datetime.utcnow().isoformat()</div><div class="t m0 x97 h3b y50b ffd fs18 fc3 sc0 lsb2 ws0">db.add(&apos;bookmarks&apos;,<span class="_"> </span>data)</div><div class="t m0 x97 h3b y50c ffd fs18 fc3 sc0 lsb2 ws0">return<span class="_"> </span>&apos;Bookmark<span class="_"> </span>added!&apos;</div><div class="t m0 x44 h15 y40e ff4 fsb fc3 sc0 ls6 ws4d1">You’ve now written all the bu<span class="_ _e"></span><span class="ls1c ws4af">siness logic needed for creati<span class="ls3a ws26d">ng bookmarks. Next, you’ll</span></span></div><div class="t m0 x44 h15 y40f ff4 fsb fc3 sc0 ls47 ws54">want to be able to list<span class="_ _e"></span> <span class="ls2e ws4d">the bookmarks you’ve added. </span></div><div class="t m0 x44 h30 yf31 ffb fsc fc2 sc0 ls6 ws0">L</div><div class="t m0 x1a h5a yf32 ffb fs20 fc2 sc0 ls163 ws0">ISTING</div><div class="t m0 x87 h30 yf31 ffb fsc fc2 sc0 ls6 ws0"> </div><div class="t m0 xd7 h5a yf32 ffb fs20 fc2 sc0 ls1c4 ws0">BOOKMARKS</div><div class="t m0 x44 h15 yf33 ff4 fsb fc3 sc0 lsb3 ws0">B<span class="_ _25"></span>a<span class="_ _1c"></span>r<span class="_ _1c"></span>k<span class="_ _1d"></span> n<span class="_ _25"></span>e<span class="_ _1c"></span>e<span class="_ _1c"></span>d<span class="_ _1c"></span>s<span class="_ _1c"></span> t<span class="_ _1c"></span>o<span class="_ _1c"></span> b<span class="_ _1c"></span>e<span class="_ _1c"></span> a<span class="_ _1c"></span>b<span class="_ _1c"></span>l<span class="_ _1c"></span>e<span class="_ _1c"></span> t<span class="_ _1c"></span>o<span class="_ _1c"></span> s<span class="_ _1c"></span>h<span class="_ _1c"></span>o<span class="_ _1c"></span>w<span class="_ _1c"></span> y<span class="_ _1c"></span>o<span class="_ _1c"></span>u<span class="_ _1c"></span> t<span class="_ _1c"></span>h<span class="_ _1c"></span>e<span class="_ _1c"></span> <span class="ls38 ws126">bookmarks you’ve save<span class="lsb1 ws75d">d—without that, Bark</span></span></div><div class="t m0 x44 h15 yf34 ff4 fsb fc3 sc0 ls1c9 ws75e">wouldn’t be<span class="_ _0"></span> of much use.<span class="ls2f ws5db"> <span class="_ _0"></span>You’re going to write a </span></div><div class="t m5 xeb h24 yf35 ffd fsc fc3 sc0 lsa0 ws0">ListBookmark<span class="_ _e"></span>sCommand</div><div class="t m0 xd4 h15 yf34 ff4 fsb fc3 sc0 lsc3 ws0"> th<span class="_ _e"></span>at wi<span class="_ _e"></span>ll p<span class="_ _e"></span>ro-</div><div class="t m0 x44 h15 yf36 ff4 fsb fc3 sc0 ls1c ws10">vide the logic for displaying the bookm<span class="_ _e"></span>arks in the database.</div><div class="t m0 x32 h15 ye70 ff4 fsb fc3 sc0 lsbf ws0"> Yo<span class="_ _1d"></span>u’l<span class="_ _1d"></span>l wa<span class="_ _1d"></span>nt t<span class="_ _0"></span>o<span class="_ _0"></span> ma<span class="_ _0"></span>k<span class="_ _0"></span>e u<span class="_ _0"></span>s<span class="_ _0"></span>e o<span class="_ _0"></span>f<span class="_ _0"></span> th<span class="_ _1d"></span>e </div><div class="t m5 xca h24 yf37 ffd fsc fc3 sc0 lsa0 ws0">DatabaseMana<span class="_ _e"></span>ger.select</div><div class="t m0 x103 h15 ye70 ff4 fsb fc3 sc0 ls3b ws4b0"> method to get t<span class="_ _e"></span>he book-</div><div class="t m0 x44 h15 yf38 ff4 fsb fc3 sc0 ls30 wsb0">marks from the database. By default, SQLite<span class="ls3d ws710"> sorts records by their order of creation</span></div><div class="t m0 x44 h15 yd91 ff4 fsb fc3 sc0 ls20 ws17">(that is, by the primary key of the table), but <span class="ls31 ws25">it might also be usef<span class="ls3a ws1e0">ul to sort bookmarks</span></span></div><div class="t m0 x44 h15 yf39 ff4 fsb fc3 sc0 ls20 ws1ca">by date or title. In Bark, bookmarks’ IDs <span class="ws1c4">and dates sort identically b<span class="_ _e"></span>ecause they both</span></div><div class="t m0 x44 h15 y866 ff4 fsb fc3 sc0 ls2e ws2e1">strictly increase as you add b<span class="ls20 ws478">ookmarks, but it’s good practice<span class="ls1f ws144"> to sort expl<span class="_ _0"></span>icitly by the</span></span></div><div class="t m0 x44 h15 y868 ff4 fsb fc3 sc0 ls2f ws23">column of interest in<span class="ls31 ws25"> case that changes.</span></div><div class="t m0 x32 h15 y869 ff4 fsb fc3 sc0 ls6 ws0"> </div><div class="t m5 xbc h24 yf3a ffd fsc fc3 sc0 lsa0 ws0">ListBookmark<span class="_ _e"></span>sCommand</div><div class="t m0 xe7 h15 y869 ff4 fsb fc3 sc0 ls5e ws14a"> should do the following:</div><div class="t m0 x86 h29 yf3b ffe fs17 fca sc0 ls6 ws0"></div><div class="t m0 x87 h15 yf3c ff4 fsb fc3 sc0 lsbf ws0">Ac<span class="_ _1d"></span>cep<span class="_ _1d"></span>t t<span class="_ _0"></span>he<span class="_ _0"></span> c<span class="_ _0"></span>ol<span class="_ _1d"></span>umn<span class="_ _1d"></span> to<span class="_ _0"></span> or<span class="_ _0"></span>d<span class="_ _0"></span>er<span class="_ _1d"></span> by,<span class="_ _1d"></span> and<span class="_ _1d"></span> sa<span class="_ _0"></span>ve<span class="_ _1d"></span> it a<span class="_ _1d"></span>s an<span class="_ _1d"></span> in<span class="_ _0"></span>st<span class="_ _0"></span>a<span class="_ _0"></span>nc<span class="_ _1d"></span>e a<span class="_ _0"></span>tt<span class="_ _0"></span>r<span class="_ _0"></span>ib<span class="_ _1d"></span>ute<span class="_ _1d"></span>. Y<span class="_ _0"></span>ou<span class="_ _1d"></span> can<span class="_ _0"></span> s<span class="_ _0"></span>et</div><div class="t m0 x87 h15 yf3d ff4 fsb fc3 sc0 ls4e ws3e">the default value to </div><div class="t m5 xa8 h24 yf3e ffd fsc fc3 sc0 lsa0 ws0">date_added</div><div class="t m0 xa5 h15 yf3d ff4 fsb fc3 sc0 ls78 ws0"> if you like<span class="_ _e"></span>.</div><div class="t m0 x86 h29 yf3f ffe fs17 fca sc0 ls6 ws0"></div><div class="t m0 x87 h15 y60d ff4 fsb fc3 sc0 ls2f ws23">Pass this information along to </div><div class="t m5 xd0 h24 yf40 ffd fsc fc3 sc0 lsa0 ws0">db.select</div><div class="t m0 x50 h15 y60d ff4 fsb fc3 sc0 ls1c ws10"> in its </div><div class="t m5 x137 h24 yf40 ffd fsc fc3 sc0 lsa0 ws0">execute</div><div class="t m0 xed h15 y60d ff4 fsb fc3 sc0 ls2f ws26a"> method.</div><div class="t m0 x86 h29 yf41 ffe fs17 fca sc0 ls6 ws0"></div><div class="t m0 x87 h15 yf42 ff4 fsb fc3 sc0 ls3b ws70">Return the result (u<span class="ls3a ws4b7">sing the cursor’s </span></div><div class="t m5 x3f h24 yf43 ffd fsc fc3 sc0 lsa0 ws0">.fetchall()</div><div class="t m0 x2d h15 yf42 ff4 fsb fc3 sc0 ls20 ws202"> method) because </div><div class="t m5 x96 h24 yf43 ffd fsc fc3 sc0 lsa0 ws0">select</div><div class="t m0 x11f h15 yf42 ff4 fsb fc3 sc0 ls44 wseb"> is a</div><div class="t m0 x87 h15 yf44 ff4 fsb fc3 sc0 ls2d ws0">query.</div><div class="t m0 x44 h15 y7d3 ff4 fsb fc3 sc0 ls3d ws97">Write the command to list bo<span class="ls38 wsaa">okmarks, and come back to <span class="ls1e ws329">check your work against the</span></span></div><div class="t m0 x44 h15 y7d4 ff4 fsb fc3 sc0 ls1f ws14">following listing.</div><div class="t m0 x44 h3b yf45 ffd fs18 fc3 sc0 lsb2 ws0">class<span class="_"> </span>ListBookmarksCommand:</div><div class="t m0 xae h3b yf46 ffd fs18 fc3 sc0 lsb2 ws0">def<span class="_"> </span>__init__(self,<span class="_"> </span>order_by=&apos;date_added&apos;):</div><div class="t m0 x97 h3b yf47 ffd fs18 fc3 sc0 lsb2 ws0">self.order_by<span class="_"> </span>=<span class="_"> </span>order_by</div><div class="t m0 xae h3b yf48 ffd fs18 fc3 sc0 lsb2 ws0">def<span class="_"> </span>execute(self):</div><div class="t m0 x97 h3b yf49 ffd fs18 fc3 sc0 lsb2 ws0">return<span class="_"> </span>db.select(&apos;bookmarks&apos;,<span class="_"> </span>order_by=self.order_by).fetchall()</div><div class="t m0 x44 h15 yf4a ff4 fsb fc3 sc0 ls38 ws30c">Now you’ve got enough functionality to ad<span class="ls3a ws1cf">d bookmarks and view existing ones. The</span></div><div class="t m0 x44 h15 yf4b ff4 fsb fc3 sc0 ls31 ws25">last step for managing bookmarks <span class="ls80 wsff">is a co<span class="_ _e"></span>mmand for deleting them. </span></div><div class="t m0 x44 h30 yf4c ffb fsc fc2 sc0 ls6 ws0">D</div><div class="t m0 x12c h5a yf4d ffb fs20 fc2 sc0 ls1bf ws0">ELETING</div><div class="t m0 x102 h30 yf4c ffb fsc fc2 sc0 ls6 ws0"> </div><div class="t m0 x97 h5a yf4d ffb fs20 fc2 sc0 ls1b3 ws0">BOOKMARKS</div><div class="t m0 x44 h15 yf4e ff4 fsb fc3 sc0 ls34 ws3ae">Similar to adding a new bookmark, the dele<span class="ls42 ws2a0">tion of a <span class="_ _e"></span>bookmark requires some data to</span></div><div class="t m0 x44 h15 yf4f ff4 fsb fc3 sc0 ls42 ws1f2">be passed from the presentation layer. This time, though, the data is simply an integer</div><div class="t m0 x44 h15 yf50 ff4 fsb fc3 sc0 ls48 ws39">value representing the ID of<span class="_ _e"></span><span class="lsab ws210"> the boo<span class="_ _0"></span>kmark to delete.</span></div><div class="t m0 x37 h20 yf51 ffb fs7 fc4 sc0 ls6 ws0">A command to list existing bookmarks<span class="_ _b0"></span>Listing<span class="_"> </span>6.8</div><div class="c xe9 yf52 w6d hda"><div class="t m0 x12e h14 yf53 ff12 fs7 fcb sc0 ls13c ws75f">Adds the cu<span class="ff13 ls123 ws0">rr<span class="ff12 ls6">e<span class="ff13">n</span><span class="lsd2">t </span></span></span></div><div class="t m0 x12e h14 yf54 ff12 fs7 fcb sc0 ls10c ws0">dateti<span class="ff13 ls6">m</span><span class="ls12f ws64e">e as the </span></div><div class="t m0 x12e h14 yf55 ff13 fs7 fcb sc0 ls6 ws0">r<span class="ff12">eco</span>r<span class="ff12 ls10e ws4f1">d is added</span></div></div><div class="c x138 yf56 w2d h8c"><div class="t m0 xfb h14 yf57 ff12 fs7 fcb sc0 lsec ws0">Usi<span class="ff13 ls6">n</span><span class="lsda ws2aa">g the DatabaseMa</span><span class="ff13 ls6">n</span><span class="ls127">age<span class="ff13 ls6">r</span><span class="lsde">.add <span class="ff13 ls6">m</span><span class="lsdc">ethod </span></span></span></div><div class="t m0 xfb h14 yf58 ff13 fs7 fcb sc0 ls6 ws0">m<span class="ff12 ls10a ws470">akes sho</span>r<span class="ff12 lsff ws38b">t wo</span>r<span class="ff12 lsfd ws310">k of addi</span>n<span class="ff12 ls127 ws505">g a </span>r<span class="ff12">eco</span>r<span class="ff12 lsec">d.</span></div></div><div class="c x6b yf59 w3f h46"><div class="t m0 xea h14 y2ed ff12 fs7 fcb sc0 lsfe ws313">You’ll use this <span class="ff13 ls6 ws0">m</span><span class="lse4 ws318">essage i<span class="ff13 ls6 ws0">n<span class="ff12"> </span></span></span></div><div class="t m0 xea h14 y2ee ff12 fs7 fcb sc0 ls6 ws317">the p<span class="ff13 ws0">r<span class="ff12 lsd9">ese</span>n<span class="ff12 ls181">tatio</span>n</span><span class="ls10c ws35a"> laye</span><span class="ff13 ws0">r</span><span class="ls105 ws325"> late</span><span class="ff13 ws0">r<span class="ff12">.</span></span></div></div><div class="c xe7 yf5a w6e hdb"><div class="t m0 x131 h14 yf5b ff12 fs7 fcb sc0 ls10c ws3d9">You ca<span class="ff13 ls6 ws0">n<span class="ff12 lse1"> c</span>r</span><span class="ls171 ws459">eate a v<span class="_ _e"></span>e<span class="ff13 ls6 ws0">r<span class="ff12 ls10e">sio</span>n</span><span class="ls172 ws566"> of this</span></span></div><div class="t m0 xf9 h14 yf5c ff12 fs7 fcb sc0 ls6 ws0">co<span class="ff13 ls10e">mm</span>a<span class="ff13">n</span><span class="lsd3 ws760">d fo</span><span class="ff13">r</span><span class="ls119 ws761"> so</span><span class="ff13">r</span><span class="lsd2">ti</span><span class="ff13">n</span><span class="lse0 ws762">g by date o<span class="_ _0"></span><span class="ff13 ls6 ws0">r<span class="ff12 lse0 ws762"> by title.</span></span></span></div></div><div class="c x120 yf5d w6f hdc"><div class="t m0 xb7 h14 yf5e ff12 fs7 fcb sc0 ls6 ws0">db.select <span class="ff13">r</span><span class="ls117">etu<span class="ff13 ls123">rn</span><span class="ls10e ws55a">s a</span></span></div><div class="t m0 xfd h14 yf5f ff12 fs7 fcb sc0 ls6 ws0">cu<span class="ff13">r</span><span class="ls10e">so</span><span class="ff13">r</span><span class="lsee ws2cf"> you ca</span><span class="ff13">n</span></div><div class="t m0 xf4 h14 yf60 ff12 fs7 fcb sc0 ls170 ws0">ite<span class="ff13 ls6">r<span class="ff12 ws317">ate ove</span>r</span><span class="ls106 ws45d"> to get</span></div><div class="t m0 x127 h14 yf61 ff12 fs7 fcb sc0 lsd2 ws0">the <span class="ff13 ls6">r<span class="ff12">eco</span>r</span><span class="lsec">ds.</span></div></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
