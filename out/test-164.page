<div id="pfa4" class="pf w0 h0" data-page-no="a4"><div class="pc pca4 w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bga4.png"/><div class="t m0 x42 h14 y80 ff7 fs7 fcb sc0 ls6 ws0">140</div><div class="t m0 xb9 h2b y1cf ffb fs18 fcb sc0 ls6 ws0">C</div><div class="t m0 x16 h2c y1d0 ffb fs19 fcb sc0 lsf6 ws0">HAPTER</div><div class="t m0 x68 h2b y1cf ffb fs18 fcb sc0 ls8c ws0"> 7</div><div class="t m0 x1f h2d y80 ffa fs7 fcb sc0 ls6 ws0">Extensibility and f<span class="_ _e"></span>lexibility</div><div class="t m0 x44 h15 y40 ff4 fsb fc3 sc0 ls2d ws815">You’ve now improved the flexibility of </div><div class="t m5 xf h24 y3eb ffd fsc fc3 sc0 lsa0 ws0">AddBookmarkCo<span class="_ _e"></span>mmand</div><div class="t m0 x5 h15 y40 ff4 fsb fc3 sc0 ls20 ws816">, and it’s extensible</div><div class="t m0 x44 h15 y41 ff4 fsb fc3 sc0 ls20 ws94">enough to handle what you need <span class="_ _e"></span>for the GitHub stars importer. You won’t <span class="_ _e"></span>need any</div><div class="t m0 x44 h15 y42 ff4 fsb fc3 sc0 ls51 ws37f">new functionality at the persistence layer, <span class="ls1c ws37a">so you can focus on the presentation and</span></div><div class="t m0 x44 h15 y43 ff4 fsb fc3 sc0 ls1c ws21d">business logic for this new <span class="_ _e"></span>feature. Give it<span class="lsc9 ws0"> a<span class="_ _1d"></span> s<span class="_ _1d"></span>h<span class="_ _1d"></span>o<span class="_ _1d"></span>t<span class="_ _1c"></span> a<span class="_ _1d"></span>n<span class="_ _1d"></span>d<span class="_ _1d"></span> c<span class="_ _1d"></span>o<span class="_ _1d"></span>m<span class="_ _1d"></span>e<span class="_ _1d"></span> b<span class="_ _1d"></span>a<span class="_ _1d"></span>c<span class="_ _1d"></span>k<span class="_ _1d"></span> t<span class="_ _1d"></span>o<span class="_ _1d"></span> c<span class="_ _1d"></span>h<span class="_ _1d"></span>e<span class="_ _1d"></span>c<span class="_ _1d"></span>k<span class="_ _1d"></span> y<span class="_ _1d"></span>o<span class="_ _1d"></span>u<span class="_ _1d"></span>r<span class="_ _1d"></span> w<span class="_ _1d"></span>o<span class="_ _1d"></span>r<span class="_ _1d"></span>k</span></div><div class="t m0 x44 h15 y44 ff4 fsb fc3 sc0 ls5e ws57">against the following two listings.</div><div class="t m0 x44 h3b y2ca ffd fs18 fc3 sc0 lsb2 ws0">class<span class="_"> </span>ImportGitHubStarsCommand:</div><div class="t m0 xae h3b y1192 ffd fs18 fc3 sc0 lsb2 ws0">def<span class="_"> </span>_extract_bookmark_info(self,<span class="_"> </span>repo):</div><div class="t m0 x97 h3b y2cc ffd fs18 fc3 sc0 lsb2 ws0">return<span class="_"> </span>{</div><div class="t m0 xc3 h3b y2cd ffd fs18 fc3 sc0 lsb2 ws0">&apos;title&apos;:<span class="_"> </span>repo[&apos;name&apos;],</div><div class="t m0 xc3 h3b y2ce ffd fs18 fc3 sc0 lsb2 ws0">&apos;url&apos;:<span class="_"> </span>repo[&apos;html_url&apos;],</div><div class="t m0 xc3 h3b y1193 ffd fs18 fc3 sc0 lsb2 ws0">&apos;notes&apos;:<span class="_"> </span>repo[&apos;description&apos;],</div><div class="t m0 x97 h3b y1194 ffd fs18 fc3 sc0 ls6 ws0">}</div><div class="t m0 xae h3b y1195 ffd fs18 fc3 sc0 lsb2 ws0">def<span class="_"> </span>execute(self,<span class="_"> </span>data):</div><div class="t m0 x97 h3b y1196 ffd fs18 fc3 sc0 lsb2 ws0">bookmarks_imported<span class="_"> </span>=<span class="_"> </span>0</div><div class="t m0 x97 h3b y944 ffd fs18 fc3 sc0 lsb2 ws0">github_username<span class="_"> </span>=<span class="_"> </span>data[&apos;github_username&apos;]</div><div class="t m0 x97 h3b y1197 ffd fs18 fc3 sc0 lsb2 ws0">next_page_of_results<span class="_"> </span>=</div><div class="t m0 x44 h51 y1198 ff9 fs15 fc9 sc0 ls6 ws0">➥</div><div class="t m0 xc4 h51 y1199 ff9 fs15 fc9 sc0 ls6 ws0"> </div><div class="t m0 x32 h3b y119a ffd fs18 fc3 sc0 lsb2 ws0">f&apos;https://api.github.com/users/{github_username}/starred&apos;</div><div class="t m0 x97 h3b y119b ffd fs18 fc3 sc0 lsb2 ws0">while<span class="_"> </span>next_page_of_results:</div><div class="t m0 xc3 h3b y119c ffd fs18 fc3 sc0 lsb2 ws0">stars_response<span class="_"> </span>=<span class="_"> </span>requests.get(</div><div class="t m0 x28 h3b y119d ffd fs18 fc3 sc0 lsb2 ws0">next_page_of_results,</div><div class="t m0 x28 h3b y119e ffd fs18 fc3 sc0 lsb2 ws0">headers={&apos;Accept&apos;:<span class="_"> </span>&apos;application/vnd.github.v3.star+json&apos;},</div><div class="t m0 xc3 h3b y119f ffd fs18 fc3 sc0 ls6 ws0">)</div><div class="t m0 xc3 h3b y11a0 ffd fs18 fc3 sc0 lsb2 ws0">next_page_of_results<span class="_"> </span>=</div><div class="t m0 x44 h51 y11a1 ff9 fs15 fc9 sc0 ls6 ws0">➥</div><div class="t m0 xc4 h51 y11a2 ff9 fs15 fc9 sc0 ls6 ws0"> </div><div class="t m0 x32 h3b y11a3 ffd fs18 fc3 sc0 lsb2 ws0">stars_response.links.get(&apos;next&apos;,<span class="_"> </span>{}).get(&apos;url&apos;)</div><div class="t m0 xc3 h3b y11a4 ffd fs18 fc3 sc0 lsb2 ws0">for<span class="_"> </span>repo_info<span class="_"> </span>in<span class="_"> </span>stars_response.json():</div><div class="t m0 x28 h3b y11a5 ffd fs18 fc3 sc0 lsb2 ws0">repo<span class="_"> </span>=<span class="_"> </span>repo_info[&apos;repo&apos;]</div><div class="t m0 x28 h3b ya15 ffd fs18 fc3 sc0 lsb2 ws0">if<span class="_"> </span>data[&apos;preserve_timestamps&apos;]:</div><div class="t m0 xd6 h3b ya16 ffd fs18 fc3 sc0 lsb2 ws0">timestamp<span class="_"> </span>=<span class="_"> </span>datetime.strptime(</div><div class="t m0 xf1 h3b y6f4 ffd fs18 fc3 sc0 lsb2 ws0">repo_info[&apos;starred_at&apos;],</div><div class="t m0 xf1 h3b y6f5 ffd fs18 fc3 sc0 lsb2 ws0">&apos;%Y-%m-%dT%H:%M:%SZ&apos;</div><div class="t m0 xd6 h3b ya17 ffd fs18 fc3 sc0 ls6 ws0">)</div><div class="t m0 x28 h3b ya18 ffd fs18 fc3 sc0 lsb2 ws0">else:</div><div class="t m0 xd6 h3b ya19 ffd fs18 fc3 sc0 lsb2 ws0">timestamp<span class="_"> </span>=<span class="_"> </span>None</div><div class="t m0 x28 h3b y11a6 ffd fs18 fc3 sc0 lsb2 ws0">bookmarks_imported<span class="_"> </span>+=<span class="_"> </span>1</div><div class="t m0 x28 h3b y11a7 ffd fs18 fc3 sc0 lsb2 ws0">AddBookmarkCommand().execute(</div><div class="t m0 xd6 h3b ya1b ffd fs18 fc3 sc0 lsb2 ws0">self._extract_bookmark_info(repo),</div><div class="t m0 xd6 h3b ya1c ffd fs18 fc3 sc0 lsb2 ws0">timestamp=timestamp,</div><div class="t m0 x28 h3b y11a8 ffd fs18 fc3 sc0 ls6 ws0">)</div><div class="t m0 x97 h3b y11a9 ffd fs18 fc3 sc0 lsb2 ws0">return<span class="_"> </span>f&apos;Imported<span class="_"> </span>{bookmarks_imported}<span class="_"> </span>bookmarks<span class="_"> </span>from<span class="_"> </span>starred<span class="_"> </span>repos!&apos;</div><div class="t m0 x88 h14 y11aa ff12 fs7 fcb sc0 ls6 ws0"> </div><div class="t m0 x37 h20 y11ab ffb fs7 fc4 sc0 ls6 ws0">A GitHub stars import command<span class="_ _c3"></span>Listing<span class="_"> </span>7.8</div><div class="c x74 y11ac w2c h79"><div class="t m0 xc8 h14 yf25 ff12 fs7 fcb sc0 lse1 ws0">Give<span class="ff13 ls6">n</span><span class="lse3 ws2b1"> a </span><span class="ff13 ls6">r</span><span class="lsde">eposito<span class="ff13 ls6">r</span><span class="ls10c ws3d9">y dictio</span><span class="ff13 ls6">n<span class="ff12">a</span>r</span><span class="ls16d">y, </span></span></div><div class="t m0 xc8 h14 y11ad ff12 fs7 fcb sc0 ls140 ws0">ext<span class="ff13 ls6">r</span><span class="lsff ws38b">act the </span><span class="ff13 ls6">n</span><span class="lsdc ws3df">eeded pieces to </span></div><div class="t m0 xc8 h14 ybfd ff12 fs7 fcb sc0 ls6 ws0">c<span class="ff13">r</span><span class="lsda ws311">eate a book</span><span class="ff13">m</span>a<span class="ff13">r</span><span class="ls100">k.</span></div></div><div class="c xe9 y11ae w1b hfc"><div class="t m0 x12e h14 y111f ff12 fs7 fcb sc0 ls10f ws35d">The URL fo<span class="ff13 ls6 ws0">r</span><span class="lsda ws2aa"> the </span></div><div class="t m0 x12e h14 y11af ff12 fs7 fcb sc0 ls103 ws0">fi<span class="ff13 ls6">r</span><span class="ls124 ws3cb">st page of sta</span><span class="ff13 ls6">r<span class="ff12"> </span></span></div><div class="t m0 x12e h14 y112a ff13 fs7 fcb sc0 ls6 ws0">r<span class="ff12 lsee">esults</span></div></div><div class="c x125 y11b0 w91 hfd"><div class="t m0 xfb h14 y11b1 ff12 fs7 fcb sc0 lsd2 ws0">Co<span class="ff13 ls6">n</span>ti<span class="ff13 ls6">n</span><span class="lsfc">ues</span></div><div class="t m0 xf9 h14 y11b2 ff12 fs7 fcb sc0 lsd5 ws0">getti<span class="ff13 ls6">n</span><span class="ls140 ws715">g sta</span><span class="ff13 ls6">r</span></div><div class="t m0 xb7 h14 y1017 ff13 fs7 fcb sc0 ls6 ws0">r<span class="ff12 lsff ws38b">esults while</span></div><div class="t m0 xf9 h14 y1018 ff13 fs7 fcb sc0 ls6 ws0">m<span class="ff12">o</span>r<span class="ff12 lsd9 ws7db">e pages</span></div><div class="t m0 x13f h14 y11b3 ff12 fs7 fcb sc0 ls127 ws0">of <span class="ff13 ls6">r</span><span class="ls10a">esults</span></div><div class="t m0 x11a h14 y101a ff12 fs7 fcb sc0 ls1e1 ws0">exist</div></div><div class="c x22 y11b4 w92 hfe"><div class="t m0 x12e h14 y11b5 ff12 fs7 fcb sc0 lsff ws38b">Gets the <span class="ff13 ls6 ws0">n</span><span class="ls102 ws3cd">ext page of <span class="ff13 ls6 ws0">r<span class="ff12 lsec">esults, </span></span></span></div><div class="t m0 x12e h14 y11b6 ff12 fs7 fcb sc0 lsff ws0">usi<span class="ff13 ls6">n</span><span class="ls118 ws690">g the </span><span class="ff13 ls6">r</span><span class="lsde ws3cf">ight heade</span><span class="ff13 ls6">r</span><span class="ws38b"> to tell </span></div><div class="t m0 x12e h14 y11b7 ff12 fs7 fcb sc0 lsdc ws2ac">the API to <span class="ff13 ls6 ws0">r<span class="ff12 ls105">etu</span><span class="ls103">rn</span></span><span class="ls146 ws4b3"> ti<span class="ff13 ls6 ws0">m<span class="ff12 lsd5">esta</span>m<span class="ff12 lsec">ps</span></span></span></div></div><div class="c xeb yd4b w93 hff"><div class="t m0 x42 h14 y11b8 ff12 fs7 fcb sc0 ls100 ws817">The Li<span class="ff13 ls6 ws0">n<span class="ff12 ws317">k heade</span>r</span><span class="lsee ws2cf"> with </span></div><div class="t m0 x42 h14 y11b9 ff13 fs7 fcb sc0 ls6 ws0">r<span class="ff12">el=</span>n<span class="ff12 lsde ws818">ext co</span>n<span class="ff12 ls146">tai</span>n<span class="ff12 ls170 ws819">s the </span></div><div class="t m0 x42 h14 y11ba ff12 fs7 fcb sc0 ls6 ws0">li<span class="ff13">n</span><span class="lse0 ws389">k to the </span><span class="ff13">n</span><span class="lsda ws2aa">ext page, </span></div><div class="t m0 x42 h14 y11bb ff12 fs7 fcb sc0 lsda ws2d2">if available.</div></div><div class="c x42 y11bc w94 hb7"><div class="t m0 xf3 h14 y11bd ff12 fs7 fcb sc0 lsdc ws2ac">The i<span class="ff13 ls6 ws0">n</span><span class="lsfd ws31a">fo about the</span></div><div class="t m0 xf3 h14 y11be ff12 fs7 fcb sc0 lsec ws0">sta<span class="ff13 ls123">rr</span><span class="lsde">ed <span class="ff13 ls6">r</span>eposito<span class="ff13 ls6">r<span class="ff12">y</span></span></span></div></div><div class="c xf6 y11bf w95 h100"><div class="t m0 xfb h14 y11c0 ff12 fs7 fcb sc0 ls19d ws7a9">The ti<span class="ff13 ls6 ws0">m<span class="ff12 lsd5">esta</span>m<span class="ff12">p</span></span></div><div class="t m0 xfd h14 y11c1 ff12 fs7 fcb sc0 ls105 ws0">whe<span class="ff13 ls6">n</span><span class="ls88 ws314"> the sta</span><span class="ff13 ls6">r</span></div><div class="t m0 x134 h14 y11c2 ff12 fs7 fcb sc0 lsde ws3cf">was c<span class="ff13 ls6 ws0">r<span class="ff12 lsd6">eated</span></span></div></div><div class="c x2b y11c3 w96 hff"><div class="t m0 x42 h14 y11c4 ff12 fs7 fcb sc0 ls122 ws0">Fo<span class="ff13 ls123">rm</span><span class="lsdc ws2ac">ats the ti</span><span class="ff13 ls6">m</span><span class="lsd5">esta<span class="ff13 ls6">m</span><span class="lsec">p </span></span></div><div class="t m0 x42 h14 y11c5 ff12 fs7 fcb sc0 ls6 ws0">i<span class="ff13">n</span><span class="ls146 ws4b3"> the sa</span><span class="ff13">m</span><span class="ls140 ws715">e fo</span><span class="ff13 ls103">rm</span><span class="ls197 ws656">at that </span></div><div class="t m0 x42 h14 y507 ff12 fs7 fcb sc0 lsd5 ws0">existi<span class="ff13 ls6">n</span><span class="lsdd ws6">g Ba</span><span class="ff13 ls6">r<span class="ff12 ws81a">k book</span>m<span class="ff12">a</span>r</span><span class="ls14e">ks </span></div><div class="t m0 x42 h14 y508 ff12 fs7 fcb sc0 lsff ws0">use</div></div><div class="c x55 y11c6 w97 hff"><div class="t m0 x42 h14 y11c7 ff12 fs7 fcb sc0 lsdc ws2ac">Executes a<span class="ff13 ls6 ws0">n<span class="ff12"> </span></span></div><div class="t m0 x42 h14 y51e ff12 fs7 fcb sc0 lsd9 ws0">AddBook<span class="ff13 ls6">m<span class="ff12">a</span>r</span><span class="lsd3">kCo<span class="ff13 ls10e">mm</span><span class="ls6">a<span class="ff13">n</span><span class="ls150">d, </span></span></span></div><div class="t m0 x42 h14 y11c8 ff12 fs7 fcb sc0 lsfd ws0">populati<span class="ff13 ls6">n</span><span class="ls105 ws325">g with the </span></div><div class="t m0 x42 h14 y11c9 ff13 fs7 fcb sc0 ls6 ws0">r<span class="ff12 lsde">eposito</span>r<span class="ff12 lsda ws311">y data</span></div></div><div class="c x54 y11ca w3a h57"><div class="t m0 x136 h14 y11cb ff12 fs7 fcb sc0 lse0 ws0">Retu<span class="ff13 ls103">rn</span><span class="ls119 ws3a3">s a </span><span class="ff13 ls6">m</span><span class="lse4 ws318">essage i</span><span class="ff13 ls6">n</span><span class="lsd9">dicati<span class="ff13 ls6">n<span class="ff12">g</span></span></span></div><div class="t m0 x119 h14 y11cc ff12 fs7 fcb sc0 ls102 ws0">how <span class="ff13 ls6">m<span class="ff12">a</span>n<span class="ff12 ws317">y sta</span>r</span><span class="ls10d ws35b">s we</span><span class="ff13 ls6">r<span class="ff12 ws317">e i</span>m</span><span class="lsec">po<span class="ff13 ls6">r</span><span class="ls105">ted</span></span></div></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
